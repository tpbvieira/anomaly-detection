%% BioMed_Central_Tex_Template_v1.06
%%                                      %
%  bmc_article.tex            ver: 1.06 %
%                                       %

%%IMPORTANT: do not delete the first line of this template
%%It must be present to enable the BMC Submission system to
%%recognise this template!!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                     %%
%%  LaTeX template for BioMed Central  %%
%%     journal article submissions     %%
%%                                     %%
%%          <8 June 2012>              %%
%%                                     %%
%%                                     %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%
%% For instructions on how to fill out this Tex template           %%
%% document please refer to Readme.html and the instructions for   %%
%% authors page on the biomed central website                      %%
%% http://www.biomedcentral.com/info/authors/                      %%
%%                                                                 %%
%% Please do not use \input{...} to include other tex files.       %%
%% Submit your LaTeX manuscript as one .tex document.              %%
%%                                                                 %%
%% All additional figures and files should be attached             %%
%% separately and not embedded in the \TeX\ document itself.       %%
%%                                                                 %%
%% BioMed Central currently use the MikTex distribution of         %%
%% TeX for Windows) of TeX and LaTeX.  This is available from      %%
%% http://www.miktex.org                                           %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% additional documentclass options:
%  [doublespacing]
%  [linenumbers]   - put the line numbers on margins

%%% loading packages, author definitions

%\documentclass[twocolumn]{bmcart}% uncomment this for twocolumn layout and comment line below
\documentclass{bmcart}
\usepackage[titletoc,title]{appendix}
%%% Load packages
\usepackage{amsthm,amsmath}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
%\RequirePackage{natbib}
%\RequirePackage{hyperref}
%\usepackage[utf8]{inputenc} %unicode support
\usepackage[mathletters]{ucs}
\usepackage[utf8x]{inputenc}
%\usepackage[applemac]{inputenc} %applemac support if unicode package fails
%\usepackage[latin1]{inputenc} %UNIX support if unicode package fails

\usepackage{algorithm,algorithmic}% http://ctan.org/pkg/algorithms

\usepackage{natbib}

\usepackage{supertabular}
\usepackage{fancybox}
\usepackage{acronym}
\usepackage{array}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{rotating}
\usepackage{tabularx}
\usepackage{colortbl}
\usepackage{multirow}
\usepackage{hhline}
\usepackage{setspace}
\usepackage{placeins}
\usepackage{longtable}
\usepackage{mathtools}
\DeclarePairedDelimiter\abs{\lvert}{\rvert}%
\DeclarePairedDelimiter\norm{\lVert}{\rVert}%
\usepackage{listings}
\usepackage{epstopdf}
\usepackage{subfigure}
\usepackage{courier}
\usepackage{amsfonts}
\usepackage{morefloats}
\usepackage{lipsum}
\newcommand*\justify{%
	\fontdimen2\font=0.4em% interword space
	\fontdimen3\font=0.2em% interword stretch
	\fontdimen4\font=0.1em% interword shrink
	\fontdimen7\font=0.1em% extra space
	%\hyphenchar\font=`\-% allowing hyphenation
}

% appendix
\usepackage{hyperref}
\usepackage{cleveref}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                             %%
%%  If you wish to display your graphics for   %%
%%  your own use using includegraphic or       %%
%%  includegraphics, then comment out the      %%
%%  following two lines of code.               %%
%%  NB: These line *must* be included when     %%
%%  submitting to BMC.                         %%
%%  All figure files must be submitted as      %%
%%  separate graphics through the BMC          %%
%%  submission process, not included in the    %%
%%  submitted article.                         %%
%%                                             %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%\def\includegraphic{}
%\def%\includegraphics{}

% Algorithmic modifications
\makeatletter
\newcommand{\ALOOP}[1]{\ALC@it\algorithmicloop\ #1%
  \begin{ALC@loop}}
\newcommand{\ENDALOOP}{\end{ALC@loop}\ALC@it\algorithmicendloop}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}
\newcommand{\algorithmicbreak}{\textbf{break}}
\newcommand{\BREAK}{\STATE \algorithmicbreak}
\makeatother

%%% Put your definitions there:
\startlocaldefs
\endlocaldefs

%%% Begin ...
\begin{document}


%%% Start of article front matter
\begin{frontmatter}

\begin{fmbox}
\dochead{Research}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the title of your article here     %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Model Order Selection and Eigen Similarity based Framework for Detection and Identification of Network Attacks}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the authors here                   %%
%%                                          %%
%% Specify information, if available,       %%
%% in the form:                             %%
%%   <key>={<id1>,<id2>}                    %%
%%   <key>=                                 %%
%% Comment or delete the keys which are     %%
%% not used. Repeat \author command as much %%
%% as required.                             %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\author[
	addressref={address1},                   % id's of addresses, e.g. {aff1,aff2}
	corref={address1},                       % id of corresponding address, if any	
	%noteref={n1},                        	% id's of article notes, if any
	email={tpbvieira@gmail.com} 				% email address
]{\inits{TPBV}\fnm{Thiago P. B.} \snm{Vieira}}
\author[
   	addressref={address1},
   	email={???????????????}
]{\inits{DFT}\fnm{Danilo F.} \snm{Tenório}}
\author[
   	addressref={address1},
   	email={???????????????}
]{\inits{JPCLC}\fnm{João Paulo C. L.} \snm{da Costa}}
\author[
   	addressref={address1,address2},
   	email={???????????????}
]{\inits{EPF}\fnm{Edison P.} \snm{de Freitas}}
%\author[
%   	addressref={address3},
%   	email={???????????????}
%]
%{\inits{CHC}\fnm{\\Carlos H.} \snm{Cardonha}}
\author[
   	addressref={address1},
   	email={???????????????}
]{\inits{RTSJ}\fnm{\\Rafael T.} \snm{de Sousa Júnior}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the authors' addresses here        %%
%%                                          %%
%% Repeat \address commands as much as      %%
%% required.                                %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\address[id=address1]{                           								% unique id
	\orgname{Department of Electrical Engineering, University of Brasilia (UnB)},	% 	university, etc
%	\street{},                     												%
	\postcode{70910-900}                                							% post or zip code
	\city{Brasília-DF},                              							% city
	\cny{Brazil}                                    								% country  
}
\address[id=address2]{%
	\orgname{Graduate Program in Electrical Engineering, Federal University of Rio Grande do Sul (UFRGS)},
%	\street{},
	\postcode{90035-190}
	\city{Porto Alegre},
	\cny{Brazil}
}
%\address[id=address3]{                           								% unique id
%	\orgname{IBM Research},	% 	university, etc
%	\street{},                     												%
%	\postcode{}                                							% post or zip code
%	\city{São Paulo},                              							% city
%	\cny{Brazil}                                    								% country  
%}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter short notes here                   %%
%%                                          %%
%% Short notes will be after addresses      %%
%% on first page.                           %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{artnotes}
	%\note{Sample of title note}     	% note to the article
	%\note[id=n1]{Equal contributor} 		% note, connected to author
\end{artnotes}

\end{fmbox}								% comment this for two column layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The Abstract begins here                 %%
%%                                          %%
%% Please refer to the Instructions for     %%
%% authors on http://www.biomedcentral.com  %%
%% and include the section headings         %%
%% accordingly for your article type.       %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{abstractbox}

\begin{abstract} % abstract

Novel schemes for attack detection are crucial to identify adaptive malicious traffic coming from sources that are quickly mobilized by attackers in high throughput communication networks. In this context, signal processing techniques have been applied to attack detection due to their capability to detect anomalies that are previously unknown, i.e. blind detection. This paper proposes a signal processing framework for the detection and identification of network attacks using concepts of model order selection (MOS), eigenvalues and similarity analysis. In order to validate our proposed framework, we consider a network traffic sample that contains malicious activity such as denial of service (DoS) and port probing. We propose to model the network traffic as a superposition of components, namely, user's operations (legitimate traffic), network service operation not related to the user (noise) and the malicious activity. The experiments performed in a real network show that the proposed blind detection approach achieves satisfactory levels of accuracy in terms of timely detection and identification of TCP/UDP ports under attack.

\end{abstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The keywords begin here                  %%
%%                                          %%
%% Put each keyword in separate \kwd{}.     %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{keyword}
	\kwd{Network Attack Detection}
	\kwd{Model Order Selection}
	\kwd{Eigen Analysis}
	\kwd{Similarity Analysis}
\end{keyword}

% MSC classifications codes, if any
%\begin{keyword}[class=AMS]
%\kwd[Primary ]{}
%\kwd{}
%\kwd[; secondary ]{}
%\end{keyword}

\end{abstractbox}
%
%\end{fmbox}% uncomment this for twcolumn layout

\end{frontmatter}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The Main Body begins here                %%
%%                                          %%
%% Please refer to the instructions for     %%
%% authors on:                              %%
%% http://www.biomedcentral.com/info/authors%%
%% and include the section headings         %%
%% accordingly for your article type.       %%
%%                                          %%
%% See the Results and Discussion section   %%
%% for details on how to create sub-sections%%
%%                                          %%
%% use \cite{...} to cite references        %%
%%  \cite{koon} and                         %%
%%  \cite{oreg,khar,zvai,xjon,schn,pond}    %%
%%  \nocite{smith,marg,hunn,advi,koha,mouse}%%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%% start of article main body
% <put your article body there>

%%%%%%%%%%%%%%%%
%% Background %%
%%
\section{Introduction}
\label{sec:introduction}

Traditionally, cyber defense methods can be effective against ordinary and conventional types of attacks, but may fail against innovative malicious techniques \cite{lakhina2005mining}. In order to be able to detect and avoid novel attacks and their variations, it is necessary to develop or improve techniques to achieve efficiency on resource consumption, processing capacity and response time. Moreover, it is also crucial to obtain high detection accuracy and capacity to detect variations of malicious patterns. Recently, signal processing schemes have being applied to the detection of malicious traffic in computer networks \cite{Lu2009,Huang2009,Zonglin2009,david2011blind,da2012improved,tenorio2013greatest}, showing advances in network traffic analysis.

Information security may consist of both technical and procedural aspects. The former includes equipment and security systems, while the latter corresponds to security rules and recommendations. Intrusion detection and intrusion prevention systems are security systems used, respectively, to detect (passively) and prevent (proactively) threats to computer systems and computer networks. Such systems can work in the following fashions: signature-based, anomaly-based or hybrid \cite{Huang2009,mudzingwa2012study}.

In the context of anomaly-based schemes, this work proposes an approach for the detection of malicious traffic in computer networks. Inspired by \cite{david2011blind,da2012improved}, this work models the network traffic using a signal processing formulation as a composition of three components: legitimate traffic, malicious traffic and noise, taking into account the incoming and outgoing traffic in certain types of network ports (TCP or UDP). Our proposed technique is based on eigenvalue analysis, model order selection (MOS) and similarity analysis. In contrast to \cite{david2011blind,da2012improved,tenorio2013greatest}, MOS and eigenvalue analysis are applied to detect time frames under attack. In addition, we also evaluate the accuracy of the proposed framework. Additionally, this proposed approach has its accuracy evaluation based on eigen similarity analysis for extracting detailed information about accurate time and network ports under attack. 

The performed experiments show that synflood, fraggle and port scan attacks can be detected accurately and with great detail in an automatic and blind fashion, applying signal processing concepts for traffic modeling and through approaches based on MOS and eigen similarity analysis. The main contributions of our proposed framework are the capability to blindly detect time frames under network attack via MOS and eigen analysis, and the detailed identification of the network attack via eigen similarity analysis.

This paper is organized as follows. In Section \ref{sec:relatedworks}, related works are discussed. Section \ref{sec:datamodel} presents the data model. Section \ref{sec:prop_getv} describes our proposed framework for blind and automatic detection of malicious traffic. Section \ref{sec:experimentalresults} discusses the experimental validation and presents the corresponding experimental results. Section \ref{sec:conclusionandfutureworks} draws the conclusions and the suggestions for future work. The Appendix \ref{sec:mos} presents mathematical concepts of examples of state-of-the-art MOS schemes.


\section{Related Works}
\label{sec:relatedworks}

Several methods have been proposed for the identification and characterization of malicious activity in computer networks. Classical methods typically employ data mining \cite{he2008applying,ghourabi2010data} and regular file analysis \cite{raynal2004honeypot} to detect patterns that indicate the presence of specific attacks in network traffic.

Data mining is often used to describe the process of extracting useful information from large databases. Multiple methods of data mining are used in \cite{he2008applying} to analyze data flow in a network with the aim of identifying characteristics of malicious traffic in large scale environments. Researchers have applied data mining techniques in log analysis \cite{ghourabi2010data} to improve intrusion detection performance. However, data mining techniques require prior collection of large data sets, which is a weakness of several schemes for online or low latency analysis \cite{Huang2009}.

Regular file analysis \cite{raynal2004honeypot} consists of using traffic analysis for detecting known patterns that indicate the presence of specific attacks, applying statistical analysis to the study of collected traffic. An essential feature of this method is that it depends on prior knowledge of the details of the attacks to be identified, and also depends on previous log collection for applying traffic analysis and reducing false positives.

Principal Component Analysis (PCA) is a statistical technique commonly used for dimensionality reduction. It uses an orthogonal transformation to convert a set of correlated variables into a set of linearly uncorrelated variables, where the first principal components have the largest variance. PCA has been used in attack detection \cite{almotairi2009technique}. However, PCA requires human intervention in order to identify abnormalities based on the eigenvalues profiles, if used without complementary techniques. Besides being prone to higher errors and false positives, such human intervention makes PCA not useful for real time applications. Therefore, in order to automate the analysis of eigenvalues profile, model order selection (MOS) schemes should be incorporated.

Signal processing techniques have been successfully applied to network anomaly detection \cite{Lu2009}. Lu and Ghorbani \cite{Lu2009} proposed a network anomaly detection model based on network flow, wavelet approximation, and system identification theory. However, their work did not address problems without significant outliers, such as port scan attacks. Zonglin \emph{et al} \cite{Zonglin2009} proposed a method to detect traffic anomaly with correlation analysis, where the correlation between traffic signals and the predicted traffic signals are used to reveal anomalies. Zonglin \emph{et al} \cite{Zonglin2009} evaluated the correlation analysis for anomaly detection, but the work was not applied to port scan and denial of service (DoS) attack detection, simultaneously. 

The data collected from honeypot systems, such as captured traffic and operating system logs, can be analyzed to obtain information about attack techniques, general trends of threats and exploits. Blind automatic detection of malicious traffic techniques have been developed for honeypots in \cite{david2011blind,da2012improved}. However, traffic on honeypot is simpler than real network traffic, because there are no running legitimate applications, due to the fact that honeypots emulate behavior of a host within a network to deceive and lure attackers \cite{zakaria2012review}. Since honeypots do not generate legitimate traffic, the amount of data captured in honeypots is significantly lower in comparison to a Network Intrusion Detection System (NIDS), which captures and analyzes the largest possible amount of network traffic \cite{david2011blind}. MOS for blind identification of malicious activities in honeypots was proposed by us in \cite{david2011blind}, which evaluated criteria for selecting the model order, through simulations and comparing the order of the resulting model with the true model order.

Lee \emph{et al} \cite{Lee2013} proposed OverSampling PCA (osPCA), which allows one to determine the anomaly of the target instance according to the variation of the resulting dominant eigenvector obtained by similarity analysis and over sampling. In contrast to Lee \emph{et al}, our framework applies MOS for detection of time frames under attack and similarity analysis to extract details for detection of time and ports under attack. Additionally, Lee \emph{et al} only evaluated their proposed scheme for covariance analysis, while we adopted covariance and correlation analysis for DoS and probing attacks, respectively.

Our proposed framework does not require either a significant amount of logs to detect attacks, nor prior data collection, in order to make comparisons and evaluate the existence of malicious traffic. Our proposed solution is automatic and blind for detection of time frames under probing and DoS attacks through MOS and eigen analysis. Moreover, we apply eigen similarity analysis to identify details of time and ports under network attacks.


\section{Data Model}
\label{sec:datamodel}

In this paper the scalars are denoted by italic letters (\emph{a, b, A, B, $α$, $β$}), vectors by lowercase bold letters (\textbf{a, b}), matrices by uppercase bold letters (\textbf{A, B}), and $a_i,_j$ denotes the (\emph{i, j}) elements of the matrix \textbf{A}. The superscripts \textsuperscript{T} and \textsuperscript{-1} are used for matrix transposition and matrix inversion, respectively. We define the operator $\rm diag(\cdot)$ that returns the vector of the main diagonal of a given matrix, the operator $\rightarrow$, which denotes the deletion of a given element from a set and the operator $\#$, that returns the rank of a matriz.

This section presents details of the simulated scenario along with a description of the dataset model as a signal superposition of legitimate traffic, noise and malicious traffic. The Subsection \ref{sec:DataCollection} describes the environment and scenario adopted in order to reproduce DoS and probing attacks. The Subsection \ref{sec:ModelingData} presents how network traffic can be modelled as signal superposition, and the Subsection \ref{sec:AnalyzedScenario} details the network traffic of synflood, fraggle and port scan attacks.

\subsection{Analyzed Scenario and Data Collection}
\label{sec:DataCollection}

The environment of the analyzed scenario is composed of two computers and one router with access to Internet and to an internal network, where the simulation of legitimate traffic, noise, DoS and port scan attacks are performed. During the traffic generation, one computer assumes the role of attacker, while the other is the victim, according to scenario represented by Figure \ref{fig:fig1}.

\begin{figure}[h!]
     \centering 
     \includegraphics[height=5cm, width=7cm]{results/figures/fig09.png}
     \caption{\csentence{Analyzed Scenario.} Scenario to reproduce legitimate traffic, noise, DoS and port scan.}
     \label{fig:fig1}
\end{figure}

Note that the set of network traffic is modeled as legitimate, noise and malicious traffic, where the victim performs legitimate activities, that can be characterized by web access. In many organizations this type of traffic is predominant, since most of corporate services are web-based, such as: web pages, customized web-based systems and cloud services. It is possible to characterize the traffic of a DHCP service as an example of noise associated with the transport layer. For malicious traffic, three types of networks attacks are evaluated: synflood, fraggle and port scan. These attacks are reproduced using well-known security tools, such as Nmap to port scan, Metaspoit to synflood and Hping to lead the fraggle attack.

A network traffic log is commonly formed by timestamp, protocol, source IP address, source port, destination IP address, destination port and additional information, according to the type of transport protocol used. The following TCP traffic log is presented in order to exemplify the collected data:
\newline
\newline
\texttt{\justify21:00:34.099289 IP 192.168.1.102.34712 > 200.221.2.45.80: Flags [S], seq 2424058224, win 14600, options [mss 1460, sackOK,TS val 244136 ecr 0,nop,wscale 7], length 0}
\newline

and the following to exemplify UDP traffic log: 
\newline
\newline
\texttt{\justify21:24:42.484858 IP 192.168.1.102.68 > 192.168.1.1.67: BOOTP/DHCP, Request from 00:26:9e:b7:82:be, length 300}
\newline 

In the proposed framework, the goal is to detect the anomalies only taking into account the traffic profile, i.e. specific information such as origin IP or day and time of the attack are not considered. Therefore, from the whole log information, we just consider the timestamp (for sequencing), port type and port number.

\subsection{Modeling Data}
\label{sec:ModelingData}

Modeling the dataset as a signal superposition, the network traffic (\textbf{X}) can be characterized as a mixture of three components: legitimate traffic (\textbf{S}), noise (\textbf{N}) and malicious traffic (\textbf{A}), according to the following expression:

\begin{equation}\label{eq:eq01}
\boldsymbol{X}^{(q)} = \boldsymbol{U}^{(q)} + \boldsymbol{N}^{(q)} + \boldsymbol{A}^{(q)},
\end{equation}
where $q$ represents the $q$-th time frame, which is a time grouping of network traffic.

The matrix $\boldsymbol{X}^{(q)} \in \mathbb{R}^{M \times N}$ consists of \emph{M} rows and \emph{N} columns. Each row represents a communication port (TCP port or UDP port), and each column represents the time, whose unit can be minutes, for instance. Each element $x_{m,n}^{(q)}$ stands for the number of times that the port $m$ appears at the $n$-th minute, at the $q$-th time frame.

The legitimate traffic $\boldsymbol{U}^{(q)}$ is characterized by the traffic from user's operations. When a user accesses a web page, for example, there is the corresponding TCP/IP traffic to request the page, as well as there is the traffic required to domain name resolution. Figure \ref{fig:fig3} depicts an example of the legitimate traffic obtained during experiments, represented by traffic to the ports 67 and 68, which are related to the Bootstrap Protocol and to normal DHCP operations, respectively.

\begin{figure}[h!]
     \centering 
     \includegraphics[height=4.5cm, width=9cm]{results/figures/fig03.png}
     \caption{\csentence{Legitimate Traffic.} The traffic from user's operations, that can be characterized by web access, traffic of well-known applications or network protocols.}
     \label{fig:fig3}
\end{figure}

All traffic, that is not directly associated with users' operations, but it is not a malicious traffic, is considered as noise $\boldsymbol{N}^{(q)}$. The automatic acquisition service of logical IP network address (DHCP) is an example of noise. Independently of any user operation, the machine receives an IP address, since it is configured to perform a DHCP address request. Figure \ref{fig:fig4} depicts an example of noise in a network traffic.

\begin{figure}[h!]
     \centering 
     \includegraphics[height=4.5cm, width=9cm]{results/figures/fig04.png}
     \caption{\csentence{Noise Traffic.} Network traffic of user independent operations for network management.}
     \label{fig:fig4}
\end{figure}

The traffic coming from a malicious activity, such as a synflood or fraggle attack, is represented by the matrix $\boldsymbol{A}^{(q)}$. For this work we only consider the traffic from port scanning and flood attacks, which aims to cause denial of service. 

We define that if the obtained $\#\boldsymbol{A}^{(q)} ≠ 0$, then there is malicious traffic in the evaluated time frame $q$, on the other hand, if the $\#\boldsymbol{A}^{(q)} = 0$, then there is no malicious traffic. This paper shows how to detect the $\#\boldsymbol{A}^{(q)}$, given only the matrix $\boldsymbol{X}^{(q)}$, in order to identify malicious network traffic.

\subsection{Synflood, Fraggle and Port scan}
\label{sec:SynfloodFraggleandPortscan}

The network attacks evaluated by this work are: synflood, fraggle and port scan. The first two attacks can be qualified as DoS attacks, while the last one can be qualified  as probing or port scanning attack.

The TCP protocol is a connection-oriented protocol, then a virtual connection must be established between two computers for an end-to-end TCP communication. This virtual connection requires a ``handshake'', that occurs in three steps, known as three-way handshake. If a computer needs to communicate with another computer, the requester sends a packet communication synchronization (SYN) to a specific destination port, which is in listening state. If the destination is active, running and accepting requests, it responds to the requester with a SYN/ACK confirmation message. After receiving this message, the requester sends an ACK message to the destination and then the connection is established.

With respect to the synflood attacks, the attacker sends a large quantity and concurrent successive SYN requests to a target, in order to consume resources and cause a DoS. Figure \ref{fig:fig5} depicts an example of a synflood attack carried out in a real computer network. In an interval of ten minutes, more than 210,000 packets are sent as a synflood attack. This network traffic behavior can be considered an abnormal behavior of network traffic, especially since it is concentrated in a short period of time and presents similar outstanding traffic during the time under attack.

\begin{figure}[h!]
     \centering 
     \includegraphics[height=4.5cm, width=9cm]{results/figures/fig05.png}
     \caption{\csentence{Synflood Traffic.} A large quantity of SYN requests to a target, in order to cause a DoS.}
     \label{fig:fig5}
\end{figure}

With respect to the fraggle atack, large packets with ``UDP echo'' segments are sent to the broadcast address of a network. Every packet is modified to have the source address of the victim, in order to implement the source address spoofing technique. Therefore, each host receives a huge amount of requests ``UDP echo'' and all of them replies to the IP address of the victim, causing a packet flooding aiming a DoS. This attack can affect the entire network, since all hosts receive several requests ``UDP echo'' and respond with the ICMP protocol, therefore each host acts as an ``amplifier'' of the attack. This last part of the fraggle attack is not taken into account in this work, because the victim receives ICMP (network layer) packets originated from the hosts that are attacked with flooding packet ``UDP echo''. This occurs due to the UDP be not able to know if the segment sent has reached its destination.

Figure \ref{fig:fig6} depicts an example of the fraggle attack in a real computer network. More than 6,000,000 malicious packets can be counted in an interval of ten minutes, which can be considered an abnormal network traffic, especially due to the concentrated traffic in a short period of time and due to the similarity of the outstanding traffic.

\begin{figure}[h!]
     \centering 
     \includegraphics[height=4.5cm, width=9cm]{results/figures/fig06.png}
     \caption{\csentence{Fraggle Traffic.} Large amount of “UDP echo” requests and replies, causing packet flooding.}
     \label{fig:fig6}
\end{figure}

Port scan is the attempt to establish a connection to TCP and UDP ports to identify what services are running or are in the listening state. There are several available port scanning techniques, including: TCP SYN scan, TCP ACK scan and UDP scan. This work evaluates the use of TCP SYN scan and UDP scan. 

In TCP SYN scan, a SYN packet is sent to the destination and two types of responses may occur: SYN/ACK or RST/ACK. In the first case, the destination port is in the listening state, in the second case, the destination port is not listening. At the end of each port scanning, a RST/ACK packet is sent by the system that is performing the port  scan. Therefore, a full connection or a complete three-way handshake is never established, which makes the detection of the attack sender more difficult, and requires approaches able to identify probing attacks without connection stablishment. The UDP scan technique sends UDP packets to the destination port, and if it responds with a ``ICMP port unreachable'' message, then it indicates that the scanned port is closed. On the other hand, if a message is not received, then the port is considered as open.

\begin{figure}[h!]
     \centering 
     \includegraphics[height=5cm, width=9cm]{results/figures/fig07.png}
     \caption{\csentence{Port Scan Traffic.} Connection attempts in order to identify active ports.}
     \label{fig:fig7}
\end{figure}

Figure \ref{fig:fig7} depicts an example of the port scan attack in a real computer network. Note that the traffic is composed of two packets for each TCP port and one UDP packet to each port. The incoming and outgoing packets analysis, for each port, shows the high correlation and similarity of TCP and UDP traffic during the simulated port scan attack.


\section{Proposed Framework for Detection and Identification of Network Attacks}
\label{sec:prop_getv}

This section describes the proposed technique to detect synflood, fraggle and port scan. In Subsection \ref{sec:prop_LargestEigenvaluebyTimeFrames} we present the steps for extraction of the largest eigenvelue for each $q$-th time frame, in order to apply a selected MOS scheme for attack detection, which is described in Subsection \ref{sec:prop_MOSSchemes}. In Subsection \ref{sec:prop_EigenvalueAnalysis}, we present the eigenvalue analysis to identify the time frames detected as under attack, and the Subsection \ref{sec:prop_EigenSimilarityAnalysis} describes the similarity analysis evaluated for detailed attack identification.

\subsection{Largest Eigenvalue by Time Frames}
\label{sec:prop_LargestEigenvaluebyTimeFrames}

The proposed attack detection algorithm starts by the data pre-processing of a network traffic log containing IP, ports and timestamp of senders and receivers. During this step, the desired information is extracted in order to classify and count packets according to the origin and destination ports, and subsequently this information is grouped by minutes and by time frames.

With the data grouped into $Q$ time frames, the framework considers the time variations of the matrix $\boldsymbol{X}^{(q)} \in \mathbb{R}^{M\times{N}}$, with $q = 1, \ldots, Q$, in order to detect the attack. 

According to DoS and port scan attacks' behavior, DoS attacks and port scan attacks can be characterized as covariance aware attack \citep{jin2004covariance} and correlation aware attack \citep{lakhina2005mining}, respectively. These characteristics are substantiated by the results obtained through the covariation and correlation analysis described in Section \ref{sec:experimentalresults}, which shows that the main components of DoS attacks are dominated by the variables with more variance and that the traffic associated with port scan attack does not generate many logs, however, it presents a highly correlated traffic.

Therefore, to detect DoS attacks, it is necessary to calculate the covariance matrix $\boldsymbol{R}_{yy}^{(q)}$ of the zero mean samples given by

\begin{equation}\label{eq:eq02}
\boldsymbol{y}_{m}^{(q)} = \boldsymbol{x}_{m}^{(q)} - \bar{\boldsymbol{x}}_{m}^{(q)}.
\end{equation}

The set of obtained vectors $\boldsymbol{y}_{m}^{(q)}$ composes the zero mean matrix $\boldsymbol{Y}^{(q)}$, then the covariance matrix $\boldsymbol{R}_{yy}^{(q)}$ can be calculated as follows

\begin{equation}\label{eq:eq03}
\boldsymbol{R}_{yy}^{(q)} = \frac{1}{N}\boldsymbol{Y}^{(q)}\boldsymbol{Y}^{(q)^{\rm T}}.
\end{equation}

For the port scan attack detection, it is necessary to calculate the correlation matrix $\boldsymbol{R}_{zz}^{(q)}$, instead of the covariance matrix $\boldsymbol{R}_{yy}^{(q)}$ used for DoS detection, since the main components are not dominated by the variables with large variance and since port scan attack presents a highly correlated network traffic. To obtain the correlation matrix $\boldsymbol{R}_{zz}^{(q)}$, it is required, for each variable, to make the standard deviation unitary as follows

\begin{equation}\label{eq:eq04}
\boldsymbol{z}_{m}^{(q)} = \frac{\boldsymbol{x}_{m}^{(q)} - \bar{\boldsymbol{x}}_{m}^{(q)}}{\boldsymbol{\sigma}_{m}^{(q)}}.
\end{equation}

The set of vectors $\boldsymbol{z}_{m}^{(q)}$ composes the matrix $\boldsymbol{Z}^{(q)}$, then the correlation matrix $\boldsymbol{R}_{zz}^{(q)}$ can be calculated via 

\begin{equation}\label{eq:eq05}
\boldsymbol{R}_{zz}^{(q)} = \frac{1}{N}\boldsymbol{Z}^{(q)}\boldsymbol{Z}^{(q)^{\rm T}}.
\end{equation}

Once the $\boldsymbol{R}_{yy}^{(q)}$ and $\boldsymbol{R}_{zz}^{(q)}$ have been obtained for DoS and port scan attack detection, respectively, for the sake of simplicity, we refer to $\boldsymbol{R}_{yy}$ and $\boldsymbol{R}_{zz}$ as a matrix $\boldsymbol{C}$. Therefore, the next step of the algorithm is the eigenvalue decomposition (EVD), calculated according to (\ref{eq:eq06}), in order to obtain the vector of eigenvalues $\boldsymbol{e}^{(q)}$ associated with each matrix, according to (\ref{eq:eq060}).

\begin{equation}\label{eq:eq06}
\boldsymbol{C}^{(q)} = \boldsymbol{V}^{(q)}\boldsymbol{\Lambda}^{(q)}\boldsymbol{V}^{(q)^{\rm T}},
\end{equation}
\begin{equation}\label{eq:eq060}
\boldsymbol{e}^{(q)} = \rm diag(\boldsymbol{\Lambda}^{(q)}).
\end{equation}

The eigenvalues should be sorted in descending order, as defined by $\lambda_{1}^{(q)} > \lambda_{2}^{(q)} > \lambda_{3}^{(q)} > ... > \lambda_{m}^{(q)}$, to make possible the selection of the first eigenvalue in the obtained sequence, represented by $\lambda_{1}^{(q)}$, which is the largest eigenvalue of the $q$-th time frame evaluated for attack detection.

The matrix of eigenvalues of $\boldsymbol{C}^{(q)}$ can be represented in the following fashion 

\begin{equation}\label{eq:eq07}
\boldsymbol{E} =
\begin{bmatrix}
  \lambda_1^{(1)} & \lambda_1^{(2)} & \lambda_1^{(3)} & \cdots & \lambda_1^{(Q)} \\
  \lambda_2^{(1)} & \lambda_2^{(2)} & \lambda_2^{(3)} & \cdots & \lambda_2^{(Q)} \\
  \lambda_3^{(1)} & \lambda_3^{(2)} & \lambda_3^{(3)} & \cdots & \lambda_3^{(Q)} \\
  \vdots & \vdots & \ddots & \vdots  \\
  \lambda_m^{(1)} & \lambda_m^{(2)} & \lambda_m^{(3)} & \cdots & \lambda_m^{(Q)} \\
\end{bmatrix}.
\end{equation}

The process of obtaining the $\boldsymbol{X}^{(q)} \in \mathbb{R}^{M\times{N}}$, $q = 1, 2, 3, ..., Q$ and the matrix $\boldsymbol{C}^{(q)}$, finding the largest eigenvalue for each $q$-th time frame, should be repeated until $q = Q$, in order to obtain the largest eigenvalue of all time frames. Since $\lambda_1^{(q)} > \lambda_2^{(q)} > \lambda_3^{(q)} > \cdots > \lambda_{m-1}^{(q)} > \lambda_m^{(q)}$, then the first line of the matrix $\boldsymbol{E}$ contains the largest eigenvalues of each $q$-th time frame, which is the Greatest Eigenvalue Time
Vector (GETV) \cite{tenorio2013greatest}, denoted as 

\begin{equation}\label{eq:eq08}
\boldsymbol{e}_{\rm max} = \boldsymbol{E}\{:,1\}.
\end{equation}

\subsection{MOS Schemes}
\label{sec:prop_MOSSchemes}

Once obtained the largest eigenvalue of each $q$-th time frame, it is possible to apply a selected MOS scheme to estimate the model order $\hat{d}$, which is the estimated number of time frames under attack. Therefore, $\boldsymbol{e}_{\rm max}$ is used as input parameter for MOS schemes, according to $\hat{d} = \rm{MOS}(\boldsymbol{e}_{\rm max})$. Note that some MOS schemes may also require the number of minutes that compose a time frame, as $\hat{d} = \rm{MOS}(\boldsymbol{e}_{\rm max},\emph{Q})$. For more information about MOS, we refer to Appendix \ref{sec:mos}.

In our previous work \cite{tenorio2013greatest}, the accuracy of AIC, MDL, EDC, RADOI, EFT and SURE schemes are evaluated for synflood and port scan attack detection, showing that EDC and EFT are effective for detecting this kind of attacks. The present work extends that evaluation to also analyse the effectiveness of the listed MOS schemes for fraggle attack detection, as shown in Section \ref{sec:experimentalresults}.

\subsection{Eigenvalue Analysis}
\label{sec:prop_EigenvalueAnalysis}

The selected MOS scheme can estimate the number of time frames under attack, denoted by $\hat{d}$, but it does not provide information of which $q$-th time frames are under attack. However, the time frames under attack can be estimated through the largest eigenvalue analysis, which indicated that the time frames with the $\hat{d}$ largest eigenvalues correspond to the $q$-th time frames under attack.

The largest eigenvalue analysis for estimating the $q$-th time frames that are under attack can be expressed as Algorithm \ref{alg:alg01}, where $\rm{\boldsymbol{\hat{q}}}_{\rm max} \in \mathbb{R}^{\hat{d}}$ denotes a vector of the $q$-th time frames under attack, which is the $q$-th indexes corresponding to the $\hat{d}$ largest eigenvalues of $\boldsymbol{e}_{\rm max}$. The Algorithm \ref{alg:alg01} initially identifies the largest value of $\boldsymbol{e}_{\rm max}$ (line 2) and its correspondent index, according to lines 4 and 5. Subsequently, the largest value is removed of $\boldsymbol{e}_{\rm max}$ (line 8) and a new iteration is performed until $\boldsymbol{e}_{\rm max} = \{\}$.

\begin{algorithm}[h!]
	\caption{Detection of Time Frames Under Attack}
  	\label{alg:alg01}
	\begin{algorithmic}[1]
		\show\LOOP
	    \ALOOP {$kk = 1$ until $kk == \hat{d}$} 
	    	    \STATE $q_{\rm value} = \argmax\limits_{\lambda}  \hspace{1 mm} \boldsymbol{e}_{\rm max}$
    	    	    \ALOOP {$i = 1$ until $i == Q$} 
				\IF {$\boldsymbol{e}_{\rm max}^{(i)} == q_{\rm value}$}
				    \STATE $\boldsymbol{\hat{q}}_{\rm max}^{(kk)} = i$
				\ENDIF
        		\ENDALOOP
	    		\STATE $\boldsymbol{e}_{\rm max} \rightarrow \boldsymbol{\hat{q}}_{\rm max}^{(kk)}$
    		\ENDALOOP
	\end{algorithmic}
\end{algorithm}

After the estimation of the $\rm{\boldsymbol{\hat{q}}}_{\rm max}$ time frames under attack, it is necessary to obtain more details of the detected attacks, such as the $n$-th minutes when the attacks happened and the $m$-th network ports that were attacked. To deal with this problem, the adoption of a similarity analysis between legitimate traffic and the traffic of time frames estimated as under attack is evaluated, analysing the effectiveness of cosine similarity to highlight abnormalies inserted by network traffic attacks. 

\subsection{Eigen Similarity Analysis}
\label{sec:prop_EigenSimilarityAnalysis}

Cosine similarity calculates the cosine of the angle between two vectors, which represents the similarity of values between the selected vectors. Therefore, cosine similarity can be used to evaluate the variation of the most significant eigenvectors of $\boldsymbol{V}^{(q)}$ against the the most significant eigenvectors of time frame detected as under attack, to analyse similarity changes into the most significant eigenvectors caused by the insertion of anomalous traffic \cite{Lee2013}. 

\subsubsection{Time Similarity Analysis}
\label{sec:prop_TimeSimilarityAnalysis}

For eigen similarity analyis, we evaluate the cosine similarity in order to identify lacks of similarity between legitimate and malicious traffic, as follows

\begin{equation}\label{eq:eq11}
s_n = \abs{\frac{\boldsymbol{v}^{(q)} \cdot \boldsymbol{v}_{(n)}}{\norm{\boldsymbol{v}^{(q)}}\norm{\boldsymbol{v}_{(n)}}}},
\end{equation}
where $s_n$ denotes the absolute similarity degree of the $n$-th minute, $\boldsymbol{v}^{(q)}$ is the most significant eigenvectors of a selected set of minutes without network attack, and $\boldsymbol{v}_{(n)}$ is the most significant eigenvectors obtained after append the target $n$-th minute of traffic to be performed the DoS and port scan attack identification.

The most significant eigenvector $\boldsymbol{v}^{(q)}$, of a time frame $q$ without attack, can be derivated from (\ref{eq:eq06}) and selected according to the eigenvector of the largest eigenvalue $\lambda_1^{(q)}$, which is the principal component of the evaluated matrix. The same calculation shall be performed in order to obtain the target eigenvectors $\boldsymbol{v}_{(n)}$, calculated from a time frame without attack plus minutes of a time frame estimated as under attack, to evaluate the occurrence of network attacks. 

The reference eigenvectors $\boldsymbol{v}^{(q)}$ is calculated from the traffic whithout attack, from a time frame $q$ composed of $Q$ minutes of legitimate network traffic. For the detailed attack identification, each $\boldsymbol{x}^{(\hat{q})}_{(n)}$ vector of each $n$-th minutes of the estimated $\rm{\boldsymbol{\hat{q}}}_{\rm max}$ time frames shall be individually appended into $\boldsymbol{X}^{(q)}$, as represented by

\begin{equation}\label{eq:eq12}
\boldsymbol{X}_{n} = \{\boldsymbol{X}^{(q)} | \boldsymbol{x}^{(\hat{q})}_{(n)}\}.
\end{equation}

The resultant $\boldsymbol{X}_{(n)}$ is necessary to obtain $\boldsymbol{v}_{(n)}$, through (\ref{eq:eq06}), for calculating the similarity degree $s_n$, ranging from 0 to 1, for each $n$-th minute. The $s_n$ denotes the absolute similarity degree of the $n$-th minute in comparison to a well-known traffic without attack, detected through MOS schemes and eigenvalue analysis.

The incremental approach for similarity analysis is based on the incremental appending of network traffic into $\boldsymbol{X}^{(q)}$, where the first evaluation is based on (\ref{eq:eq12}) and the subsequent evaluations is based on (\ref{eq:eq13}), incrementally appending each $n$-th minute until $n=N$.

\begin{equation}\label{eq:eq13}
\boldsymbol{X}_{n} = \{\boldsymbol{X}_{n} | \boldsymbol{x}^{(\hat{q})}_{(n)}\},
\end{equation}

The Figure \ref{fig:fig8} ilustrates the network traffic selection for the incremental approach of eigen similarity analysis, where the $\boldsymbol{X}^{(1)}$ is chosen as reference for similarity analysis of the $m$-th minutes of the time frame $q=3$, where one network attack was previously detected. 

\begin{figure}[h!]
     \includegraphics[height=3.6cm, width=12.4cm]{results/figures/incremental.eps}
     \caption{\csentence{Scenario.} Traffic selection for incremental approach.}
     \label{fig:fig8}
\end{figure}

The eigen similarity analysis starts at $\boldsymbol{x}^{(\hat{3})}_{(41)}$ and is incrementally performed until $\boldsymbol{x}^{(\hat{3})}_{(60)}$, in order to calculate the $s_n$. We assume that $s_n < l$ means an attack identification, according the anomaly on similiarity of $s_n$ to a defined limiar $l$. Therefore, after obtaining the most significant eigenvector $\boldsymbol{v}^{(q)}$ and the target eigenvectors $\boldsymbol{v}_{(n)}$ for eigen similarity analyis, the $s_n$ is calculated according to (\ref{eq:eq11}).

If $s_n = 1$, then the two eigenvectors are completely similar and no anomaly is detected. Smaller values of $s_n$ mean less similarity and can indicate an anomaly, according to a defined 
threshold $l$, assuming that if $s_n < l$, then a network attack is identified during the $n$-th minute. Therefore, the $s_n$ of each $n$-th minute shall be compared with the threshold $l$ to evaluate if a attack was identified, according to

\begin{equation}\label{eq:eq14}
  \boldsymbol{\hat{n}_{(n)}}=\left\{
  \begin{array}{@{}ll@{}}
    1, & \text{if}\ s_n < l \\
    0, & \text{otherwise}
  \end{array}\right.
\end{equation}
where $\boldsymbol{\hat{n}}_{(n)}$ denotes a vector of $n$-th minutes detected as under attack.

The eigen similarity analysis can also be applied in an individual fashion, where each $n$-th minute must be individually appended into $\boldsymbol{X}^{(q)}$, as shown by Figure \ref{fig:fig9}.

\begin{figure}[h!]
     \includegraphics[height=3.6cm, width=12.4cm]{results/figures/individualized.eps}
     \caption{\csentence{Scenario.} Traffic selection for individual approach.}
     \label{fig:fig9}
\end{figure}

The incremental and the individual approaches can be combined to obtain the incremental individualized approach, where each minute is incrementally appended into the selected $\boldsymbol{X}^{(q)}$ for obtaining $\boldsymbol{v}_{(n)}$ to similarity analysis of the $n$-th minute, until detect the first $n$-th minute under attack. Subsequently, $\boldsymbol{X}_n$ becomes the new reference of traffic without network attack and each subsequent minute must have its similarity individually evaluated, as shown in Figure \ref{fig:fig2}.

\begin{figure}[h!]
     \includegraphics[height=3.6cm, width=12.4cm]{results/figures/incremental_individualized.eps}
     \caption{\csentence{Scenario.} Traffic selection for incremental individualized approach.}
     \label{fig:fig2}
\end{figure}

This approach of incremental similarity analysis followed by individual analysis after an attack detection allows to identify the attack period, highlighting the first and last time under attack. This identification is possible due to the variation of the most significant eigenvectors, which becomes more significant when compared a traffic under attack against a traffic with no attack, according to results which are discussed in Section \ref{sec:experimentalresults}.

\subsubsection{Port Similarity Analysis}
\label{sec:prop_PortSimilarityAnalysis}

Given $\boldsymbol{\hat{n}}$, which is the set of $n$-th minutes under attack, it is still necessary to obtain more details about the identified network attack, such as the network ports that are attacked during each $n$-th minute identified as under attack. Hence, it is also applied the cosine similarity analysis to identify variation of the most significant eigenvectors, caused by the insertion of anomalous network traffic by a selected $m$-th port during a $n$-th minute. 

For detection of ports under attack, the $\boldsymbol{v}^{(q)}$ last most significant eigenvectors without attack shall be used as reference for similarity analysis against the $\boldsymbol{v}_{(n)}$ identified as under attack, individually evaluating the cosine similarity of each $m$-th port of all $\boldsymbol{\hat{n}}$ minutes.

Therefore, $\boldsymbol{v}^{(q)}$ should be calculated from the last $\boldsymbol{X}^{(q)}$ time frame without attack, and $\boldsymbol{v}_{(m,\hat{n})}$ should be calculated from the same traffic appened of all $n$-th minutes until the identified minute under attack, denoted as $\boldsymbol{X}_n$. 

For similarity analyis, each $m$-th port of the last $n$-th minute of $\boldsymbol{X}_n$, denoted as $x_{(m,n)}$, shall be individually replaced by the traffic of the evaluated $m$-th port of the $\hat{n}$-th minute under attack, denoted as $x^{(\hat{q})}_{(m,\hat{n})}$, in order to identify significant variation on similarity caused by the traffic of the $m$-th port. 

This approach for detection of ports under attack via similarity analysis is given by

\begin{equation}\label{eq:eq15}
  \left\{
  \begin{array}{@{}ll@{}}
    x_{(m,n)} = x^{(\hat{q})}_{(m,\hat{n})} \\
    \\
    s_{m,\hat{n}} = \abs{\frac{\boldsymbol{v}^{(q)} \cdot \boldsymbol{v}_{(m,\hat{n})}}{\norm{\boldsymbol{v}^{(q)}}\norm{\boldsymbol{v}_{(m,\hat{n})}}}},
  \end{array}\right.
\end{equation}
where $x^{(\hat{q})}_{(m,\hat{n})}$ denotes the $m$-th port of the selected $n$-th minute identified as under attack and $x_{(m,n)}$ denotes the $m$-th port of the last $n$-th minute of $\boldsymbol{X}_n$, which is used to calculate the $\boldsymbol{v}_{(m,\hat{n})}$ most significant eigenvectors that contains the traffic of the $m$-th port of the $\hat{n}$-th minute identified as under attack.

Once $\boldsymbol{v}^{(q)}$ and $\boldsymbol{v}_{(m,\hat{n})}$ are obtained, then the $s_{m,\hat{n}}$ similarity degree can be calculated in order to identify if the traffic replacement highlights the adition of anomalous traffic by the evaluated $m$-th port during the $\hat{n}$-th minute previously identified as under attack. 

This procedure should be repeated for each $m$-th target port of $\boldsymbol{\hat{n}}$, in order to individually identify the network ports under attack during each $\hat{q}$-th time frame.

%The algorithm described above can be summarized as following:
%\begin{algorithm}[h!]
%  \caption{GETV Attack Detection}
%  \label{alg:alg01}
%  \begin{algorithmic}[1]
%  \show\LOOP
%    \REQUIRE Network Traffic Log
%    \ENSURE GETV
%    \STATE $\textbf{X}$ = matrix of ports and its occurrences per time \emph{\COMMENT{Data Pre-Processing}}
%    \STATE $Q$ = number of time frames
%    \ALOOP {$q=1$ util $q=Q$} 
%        \STATE $\boldsymbol{X}^{(q)} \in \mathbb{R}^{M\times{N}}$
%        \IF {$isDosAttack$}
%            \STATE $\boldsymbol{y}_{m}^{(q)} = \boldsymbol{x}_{m}^{(q)} - \bar{\boldsymbol{x}}_{m}^{(q)}$
%            \STATE $\boldsymbol{C}_{yy}^{(q)} = \frac{1}{N}\boldsymbol{Y}^{(q)}\boldsymbol{Y}^{(q)^{\rm T}}$
%        \ENDIF
%        \IF {$isPortscanAttack$}
%			\STATE $\boldsymbol{y}_{m}^{(q)} = \frac{\boldsymbol{x}_{m}^{(q)} - \bar{\boldsymbol{x}}_{m}^{(q)}}{\boldsymbol{\sigma}_{m}^{(q)}}$
%			\STATE $\boldsymbol{R}_{yy}^{(q)} = \frac{1}{N}\boldsymbol{Y}^{(q)}\boldsymbol{Y}^{(q)^{\rm T}}$
%		\ENDIF
%		\STATE $\boldsymbol{e}^{(q)} = \boldsymbol{e}^{(q)}\boldsymbol{\Lambda}^{(q)}\boldsymbol{e}^{(q)^{\rm T}}$
%       \STATE $[\lambda_{m}^{(1)},\lambda_{m}^{(2)},\lambda_{m}^{(3)}, ..., \lambda_{m}^{(q)}] = \boldsymbol{e}^{(q)}$                        
%        \STATE $\lambda_{m}^{(1)} > \lambda_{m}^{(2)} > \lambda_{m}^{(3)} > ... > \lambda_{m}^{(q)}$
%    \ENDALOOP
%	\STATE $\boldsymbol{E} =
%		\begin{bmatrix}
%			\lambda_1^{(1)} & \lambda_1^{(2)} & \lambda_1^{(3)} & \cdots & \lambda_1^{(Q)} \\
%			\lambda_2^{(1)} & \lambda_2^{(2)} & \lambda_2^{(3)} & \cdots & \lambda_2^{(Q)} \\
%			\lambda_3^{(1)} & \lambda_3^{(2)} & \lambda_3^{(3)} & \cdots & \lambda_3^{(Q)} \\
%			\vdots & \vdots & \ddots & \vdots  \\
%			\lambda_m^{(1)} & \lambda_m^{(2)} & \lambda_m^{(3)} & \cdots & \lambda_m^{(Q)} \\
%		\end{bmatrix}$
%	\STATE $\boldsymbol{E}_{1}^{q} = \lambda_1^{(1)}, \lambda_1^{(2)}, \lambda_1^{(3)}, \cdots, \lambda_1^{(q)}$
%	\STATE $\boldsymbol{e}_{\rm max} = \boldsymbol{E}_{1}^{q}$
%  \end{algorithmic}
%\end{algorithm}

\section{Experiments and Results}
\label{sec:experimentalresults}

This section presents the performed experiments and the acquired results. First, in Section \ref{sec:AnalyzedScenario}, the scenario adopted in the experiments is summarized. Then, the Section \ref{sec:largesteigenvaluesanalysis} shows the results of the largest eigenvalue analysis by time frames. In Section \ref{sec:MOSSchemesEvaluation} are described the results of the evaluated MOS schemes for attack detection. The Section \ref{sec:EigenvalueAnalysis} presents the results of the eigenvalue analysis for identification of time frames under attack, and the Section \ref{sec:EigenSimilarityAnalysis} shows the obtained results of similarity analysis for detailed DoS and port scan attack identification.

\subsection{Analyzed Scenario}
\label{sec:AnalyzedScenario}

The experiment time is 120 minutes, separated into six time frames, with each time frame corresponding to twenty minutes. Therefore, as the time of each sampling period is one minute, then $N = 20$. For each time frame $q$, a traffic matrix $\boldsymbol{X}^{(q)} \in \mathbb{R}^{17 \times 20}$ was obtained, as well as a covariance $\boldsymbol{R}_{yy}^{(q)} \in \mathbb{R}^{17 \times 17}$ (calculated via (\ref{eq:eq03})) and a correlation matrix $\boldsymbol{R}_{zz}^{(q)} \in \mathbb{R}^{17x17}$, assuming that $q = 1, 2, 3, 4, 5$ and $6$. 

The simulation started at 21:00h, the first time frame was from 21:00h until 21:20h ($q = 1$), the second was from 21:20h until 21:40h ($q = 2$), the third was from 21:40h to 22:00h ($q = 3$), the fourth was from 22:00h until 22:20h ($q = 4$), the fifth was from 22:20h until 22:40h ($q = 5$), and finally, the sixth was from 22:40h until 23.00h ($q = 6$). During the simulation, the victim made legitimate access, and the attacker performed the following attacks: at 21:54h ($q = 3$) was performed a port scan, at the interval ranging from 22:10h to 22:20h ($q = 4$) a synflood attack was simulated, and at the interval from 22:30h to 22:40h ($q = 5$) a fraggle attack was performed.

\subsection{Largest Eigenvalues Analysis}
\label{sec:largesteigenvaluesanalysis}

For the evaluation of MOS Schemes acuracy for DoS and port scan detection, our framework defines that it is necessary to obtain the largest eigenvalue of each time frame, through eigen decomposition from a covariance or correlation matrix calculated from the evaluated traffic, as described in Section \ref{sec:prop_getv}. Through eigenvalue analysis of traffic with DoS or port scan attacks, it is possible to visualize a significant difference between the largest eigenvalues and the remain eigenvalues, which can indicate a relationship between an outlier and time frames under attack.

Figure \ref{fig:fig10} depics the eigenvalues calculated from covariance matrix of the network traffic used to evaluate the synflood attack identification. 

\begin{figure}[h!]
     \includegraphics[height=5cm, width=7cm]{results/figures/eigenvalues_synflood.eps} 
     \caption{\csentence{Synflood Eigenvalues.} Eigenvalues of the covariance matrix (synflood).}
     \label{fig:fig10}
\end{figure}

In this figure its possible to see that the largest eigenvalue, which is related to the simulated synflood attack ($q = 4$), stands out significantly from the others eigenvalues.

Figure \ref{fig:fig11} illustrates represents the eigenvalues calculated from covariance matrix of the matrix used for fraggle attack detection. In this figure it is possible to see that the largest eigenvalue, which is related to this attack ($q = 5$), stands out significantly from the others eigenvalues, in accordance with the result shown in Figure \ref{fig:fig10} for the synflood attack analysis.

\begin{figure}[h!]
     \includegraphics[height=5cm, width=7cm]{results/figures/eigenvalues_fraggle.eps}
     \caption{\csentence{Fraggle Eigenvalues.} Eigenvalues of the covariance matrix (fraggle).}
     \label{fig:fig11}
\end{figure}

Figure \ref{fig:fig12} depics the eigenvalues calculated from correlation matrix of the network traffic matrix evaluated for port scan detection. 

\begin{figure}[h!]
     \includegraphics[height=5cm, width=7cm]{results/figures/eigenvalues_portscan.eps}
     \caption{\csentence{Port Scan Eigenvalues.} Eigenvalues of the correlation matrix (port scan).}
     \label{fig:fig12}
\end{figure}

As analyzed for the synflood and fraggle attacks, it is possible to observe that the largest eigenvalue, related to this attack ($q = 3$), stands out significantly from the others eigenvalues.

Table \ref{tab:tab3} presents the values of the largest eigenvalues of each time frame $q$-th for port scan, synflood and fraggle detection. 

\begin{table}[h!]
  \centering
  \footnotesize
  \caption{Largest Eigenvalue related to attacks detection}
  \label{tab:tab3}
  \begin{tabular}{ c c c c c }
	\toprule
	\multirow{3}{*}{\textbf{Time Frame} $q$} &\multicolumn{4}{c }{\textbf{Vectors GETV}}\\ 
			\hhline{~----}
		&\textbf{Detection of}	 &\textbf{Detection of}	 &\textbf{Detection of}	 &\textbf{Detection of}\\
		&\textbf{\emph{synflood/fraggle}}	 &\textbf{\emph{synflood}}	 &\textbf{\emph{fraggle}}	 &\textbf{\emph{port scan}}\\
	\midrule
	1 &1887545 &1887545 &1887545 &2,0734 \\
	2 &2341327 &2341327 &2341327 &2,1451 \\
	3 &3213867 &3213867 &3213867 &10,0718 \\
	4 &133238294 &133238294 &731229 &2,1620 \\
	5 &92384021611 &6367983 &92384021611 &2,4253 \\
	6 &708335 &708335 &708335 &1,7948 \\
    \bottomrule
  \end{tabular}
\end{table}

In Table \ref{tab:tab3}, note the significant variation of the eigenvalues associated with attacks, in comparison to the others. At $q = 4$, where the synflood attack occurred, the maximum eigenvalue obtained was approximately 21 times larger than the second one. At $q = 5$, where the fraggle attack occurred, the maximum eigenvalue obtained was about 29,000 times larger than the second one. At $q = 3$, where the port scan attack occurred, the maximum eigenvalue obtained was approximately 4 times larger than the second one. In the last case, for port scan attack detection, although the largest eigenvalue presented no too large variance to the second one, if compared to synflood or fraggle attacks, it clearly deviates from the remaining largest eigenvalues.

These results highlight that all $q$-th time frames, where a network attack was simulated, presented high significant variance between the largest eigenvalue and the remaining eigenvalues, obtained from covariance matrix, for DoS detection, or from correlation matrix, for port scan detection. Therefore, we propose to apply the vector of the largest eigenvalues to MOS schemes in order to evaluate their accuracy for identification of time frames under attack, motivated by the fact that it is relevant to apply MOS schemes to automate the attack detection process, taking into account the characteristics of the evaluated eigenvalues.

\subsection{MOS Schemes Evaluation}
\label{sec:MOSSchemesEvaluation}

In \cite{tenorio2013greatest}, we evaluated the accuracy of AIC, MDL, EDC, RADOI, EFT and SURE MOS schemes \cite{da2009comparison,tenorio2013greatest} for synflood and port scan attack detection. In this work we extended that evaluation for fraggle attack detection, applying the same schemes to fraggle attack detection over the traffic presented in Section \ref{sec:datamodel}, as results shown on following Table \ref{tab:tab4}.

\begin{table}[h!]
  \centering
  \footnotesize
  \caption{MOS schemes applied to port scan and DoS detection}
  \label{tab:tab4}
  \begin{tabular}{ c c c c c c c c }
	\toprule
	\multirow{2}{*}{\textbf{Type of analysis} $q$} &\multicolumn{6}{c}{\textbf{MOS schemes (estimated model order $\hat{d}$)}} &{\textbf{Real value (d)}}\\ 
			\hhline{~------~}
		&\textbf{AIC} &\textbf{MDL} &\textbf{EDC} &\textbf{RADOI} &\textbf{EFT} &\textbf{SURE}\\
	\midrule
	Detection of synflood \\(presence of attack) &2 &1 &\textbf{1} &5 &\textbf{1} &4 &\textbf{1} \\
	Detection of synflood \\(absence of attack) &1 &1 &\textbf{0} &1 &\textbf{0} &3 &\textbf{0} \\
	\midrule
	Detection of fraggle \\(presence of attack) &1 &1 &\textbf{1} &5 &\textbf{1} &4 &\textbf{1} \\
	Detection of fraggle \\(absence of attack) &1 &1 &\textbf{0} &1 &\textbf{0} &3 &\textbf{0} \\
	\midrule
	Detection of port scan \\(presence of attack) &1 &1 &\textbf{1} &1 &\textbf{1} &9 &\textbf{1} \\
	Detection of port scan \\(absence of attack) &0 &0 &\textbf{0} &1 &\textbf{0} &1 &\textbf{0} \\
	\midrule
	Detection of synflood/fraggle \\(presence of attack) &2 &2 &\textbf{2} &5 &\textbf{2} &5 &\textbf{2} \\
	Detection of synflood/fraggle \\(absence of attack) &1 &1 &\textbf{0} &1 &\textbf{0} &3 &\textbf{0} \\
    \bottomrule
  \end{tabular}
\end{table}

It was expected 1 as the model order value $\hat{d}$ when there was only one attack, values greater than 1, returned by one MOS scheme, indicates that there is more than one attack. An example of this could be seen for attack detection via EFT for traffic containing synflood and fraggle attacks, showing $\hat{d} = 2$, which indicates the presence of two attacks, as expected by the $d$ real values of Table \ref{tab:tab4}. 

In Table \ref{tab:tab4}, two MOS schemes outperforms from the others, EDC and EFT. Efficient Detection Criterion (EDC) and Exponential Fitting Test (EFT) are the most effective schemes, correctly estimating the number of attacks in comparison to the expected values for effetctive attack detection, as defined by the column of real values in Table \ref{tab:tab4}. The AIC and MDL schemes are satisfactory only for port scan detection, however SURE and RADOI schemes did not show effective results for port scan or DoS detection.

Although EDC and EFT presented the same accuracy on our evaluation, the EDC scheme requires less processing time than EFT, which is an important criteria to select EDC as the MOS scheme for DoS and port scan detection on our remain experiments.

According to Table \ref{tab:tab4}, EDC and EFT estimated correctly the number of attacks of a time frame vector, indicating that ocurred $\hat{d}$ network attacks, but not providing additional details, what highlights the necessity of complementary approaches in order to estimate the time and ports under attack. Hence, we propose apply eigen analysis to estimate the $q$-th time frames under attack and eigen similarity analysis to estimate the minutes and ports under attack.

\subsection{Eigenvalue Analysis}
\label{sec:EigenvalueAnalysis}

According to the results presented in Section \ref{sec:largesteigenvaluesanalysis}, the largest eigenvalue stands out significantly from the others eigenvalues of an evaluated $q$-th time frame. This behavior can also be observed in the largest eigenvalues analysis, according to results presented in Table \ref{tab:tab3}, where it is possible to observe that the $\hat{d}$ largest eigen values of the time frames under attacks stand out significantly from the others largest eigenvalues. 

Therefore, we conclude that the $\hat{d}$ largest eigenvalues correspond to the respectives $q$-th time frames under attack, which is denoted by $\rm{\boldsymbol{\hat{q}}}_{\rm max}$ and can be calculated according to Algorithm \ref{alg:alg01}.

\subsection{Eigen Similarity Analysis}
\label{sec:EigenSimilarityAnalysis}

This paper proposes applying eigen similarity analysis to detect time and ports under attack, from each $q$-th time frames under attack defined by $\rm{\boldsymbol{\hat{q}}}_{\rm max}$. Hence, the proposed framework was applied to the time frames where $q=3$, $q=4$ and $q=5$ to respectively evaluate its effectiveness for port scan, synflood and fraggle attack detection.

\subsubsection{Time Analysis}
\label{sec:TimeAnalysis}

Three approaches were evaluated for eigen similarity analysis: incremental, individual and incremental individualized approaches. For the incremental individualized approach, each minute was incrementally appended into the selected $\boldsymbol{X}^{(q)}$ for obtaining $\boldsymbol{v}_{(n)}$ to similarity analysis of the $n$-th minute, until detect the first $n$-th minute under attack. Subsequently, $\boldsymbol{X}_n$ became the new reference of traffic without network attack and each subsequent minute must have its similarity individually evaluated. For the incremental approach, each $n$-th minute must be incrementally appended into $\boldsymbol{X}^{(q)}$, for obtaining the next eigenvectors $\boldsymbol{v}_{(n)}$ for individual time similarity analyis. For the individual approach, each $n$-th minute must be individually appended into $\boldsymbol{X}^{(q)}$, without incremental append, but doing individual appended into $\boldsymbol{X}^{(q)}$ for obtaining the next eigenvectors $\boldsymbol{v}_{(n)}$ for individual similarity analyis.

The Table \ref{tab:tab5} presents the results of the evaluation of three approaches for similarity analysis of eigenvectors for port scan detection.

\begin{table}[h!]
  \centering
  \footnotesize
  \caption{Eigen Similarity Analysis for Port Scan Detection}
  \label{tab:tab5}
  \begin{tabular}{ c c c c c c }
	\toprule
	\multirow{2}{*}{\textbf{Time Frame} $q$} &\multirow{2}{*}{\textbf{Time} $n$}   &\multicolumn{3}{c}{\textbf{Similarity Analysis}} &\multirow{2}{*}{\textbf{Attack?}}\\ 
			\hhline{~~---~}
			& &\textbf{Incremental Individualized} &\textbf{Incremental} &\textbf{Individual}\\
	\midrule
	3 &1 &0.9946 &0.9946 &0.9946 &no \\
	3 &2 &0.9934 &0.9934 &0.9999 &no \\
	3 &3 &0.9912 &0.9912 &0.9999 &no \\
	3 &4 &0.9888 &0.9888 &0.9999 &no \\
	3 &5 &0.9856 &0.9856 &0.9998 &no \\
	3 &6 &0.9840 &0.9840 &0.9999 &no \\
	3 &7 &0.9824 &0.9824 &1.0000 &no \\
	3 &8 &0.9794 &0.9794 &0.9999 &no \\
	3 &9 &0.9673 &0.9673 &0.9926 &no \\
	3 &10 &0.9674 &0.9674 &0.9997 &no \\
	3 &11 &0.9733 &0.9733 &0.9993 &no \\
	3 &12 &0.9702 &0.9702 &0.9993 &no \\
	3 &13 &0.9677 &0.9677 &0.9999 &no \\
	3 &14 &0.9646 &0.9646 &0.9998 &no \\
	3 &15 &0.0216 &0.0216 &0.0276 &yes \\
	3 &16 &0.9621 &0.0209 &1.0000 &no \\
	3 &17 &0.9611 &0.0199 &0.9998 &no \\
	3 &18 &0.9612 &0.0191 &0.9999 &no \\
	3 &19 &0.9613 &0.0186 &0.9998 &no \\
	3 &20 &0.9638 &0.0190 &1.0000 &no \\
    \bottomrule
  \end{tabular}
\end{table}

The Table \ref{tab:tab5} shows the evaluation of the time frame $q=3$, when the port scan attack was simulated, considering the incremental individualized, incremental and individual approaches for eigen similarity analysis. According to the presented results, it is possible to observe the high similarity between network traffic without attack, which was larger than 0.9610 for all evaluated cases, and emphasize the expressive low similarity when evaluated the traffic with the simulated port scan attack ($n=15$), which was lower than 0.0276 for all evaluated approaches.

Comparing the approaches for similarity analysis, it is possible to observe that all approaches highlight the low similarity when evaluated the traffic under attack. However, the incremental approach figured out low similarity for times without attack, where $n=16, 17, 18, 19, 20$, what indicates that the incremental approach can produce false posive results. This behaviour occurs because the incremental approaches appends all selected traffic into the reference traffic for comparison against the original reference traffic, what makes more evident the first lack of similarity but reduces the changing detection capability after an attack detection.

The Table \ref{tab:tab6} presents the results of the evaluation of the similarity analysis of eigenvectors for synflood detection. It shows the evaluation of the time frame $q=4$, when the synflood attack is simulated, considering the incremental individualized, incremental and individual approaches for eigen similarity analysis. According to the  results, it is possible to observe the high similarity between network traffic without attack, which is larger than 0.9907 for all evaluated cases, and emphasize the expressive low similarity when evaluated the traffic with synflood attack (between $n=11$ and $n=20$), which is lower than 0.1244 for all evaluated approaches.

\begin{table}[h!]
  \centering
  \footnotesize
  \caption{Eigen Similarity Analysis for Synflood Detection}
  \label{tab:tab6}
  \begin{tabular}{ c c c c c c }
	\toprule
	\multirow{2}{*}{\textbf{Time Frame} $q$} &\multirow{2}{*}{\textbf{Time} $n$}   &\multicolumn{3}{c}{\textbf{Similarity Analysis}} &\multirow{2}{*}{\textbf{Attack?}}\\ 
			\hhline{~~---~}
			& &\textbf{Incremental Individualized} &\textbf{Incremental} &\textbf{Individual}\\
	\midrule
	4 &1 &1.0000 &1.0000 &1.0000 &no \\
	4 &2 &0.9999 &0.9999 &1.0000 &no \\
	4 &3 &0.9997 &0.9997 &0.9999 &no \\
	4 &4 &0.9998 &0.9998 &1.0000 &no \\
	4 &5 &0.9965 &0.9965 &0.9908 &no \\
	4 &6 &0.9975 &0.9975 &1.0000 &no \\
	4 &7 &0.9977 &0.9977 &1.0000 &no \\
	4 &8 &0.9980 &0.9980 &1.0000 &no \\
	4 &9 &0.9987 &0.9987 &0.9999 &no \\
	4 &10 &0.9991 &0.9991 &1.0000 &no \\
	4 &11 &0.0085 &0.0085 &0.0284 &yes \\
	4 &12 &0.0162 &0.0120 &0.0343 &yes \\
	4 &13 &0.0248 &0.0158 &0.0427 &yes \\
	4 &14 &0.1243 &0.0185 &0.1041 &yes \\
	4 &15 &0.0082 &0.0162 &0.0103 &yes \\
	4 &16 &0.0404 &0.0070 &0.0580 &yes \\
	4 &17 &0.0397 &0.0007 &0.0573 &yes \\
	4 &18 &0.0408 &0.0042 &0.0584 &yes \\
	4 &19 &0.0408 &0.0079 &0.0584 &yes \\
	4 &20 &0.0477 &0.0092 &0.0757 &yes \\
    \bottomrule
  \end{tabular}
\end{table}


The incremental approach produces better results if compared with other evaluated approaches, with lower values and maximum of 0.0185 for times under attack, but this approach presents change detection limitation after the first outlier of similarity, as shown in Table \ref{tab:tab5} for port scan detection. 

Comparing the incremental individualized and the individual approaches for eigen similarity analysis, it is possible to observe that the incremental individualized approach obtain lowest values for almost all cases, except for the time $n=14$, where incremental individualized approach identified a larger similarity than the individual approach. The incremental individualized appends information about each evaluated traffic, therefore it incorporates traffic behaviours that can reduce the outlier capability detection, as ocurred for the time $n=14$.

The Table \ref{tab:tab7} presents the results of the eigen similarity analysis evaluation for fraggle detection.

\begin{table}[h!]
  \centering
  \footnotesize
  \caption{Eigen Similarity Analysis for Fraggle Detection}
  \label{tab:tab7}
  \begin{tabular}{ c c c c c c }
	\toprule
	\multirow{2}{*}{\textbf{Time Frame} $q$} &\multirow{2}{*}{\textbf{Time} $n$}   &\multicolumn{3}{c}{\textbf{Similarity Analysis}} &\multirow{2}{*}{\textbf{Attack?}}\\ 
			\hhline{~~---~}
			& &\textbf{Incremental Individualized} &\textbf{Incremental} &\textbf{Individual}\\
	\midrule
	5 &1 &1.0000 &1.0000 &1.0000 &no \\
	5 &2 &0.9999 &0.9999 &1.0000 &no \\
	5 &3 &1.0000 &1.0000 &1.0000 &no \\
	5 &4 &0.9999 &0.9999 &1.0000 &no \\
	5 &5 &0.9993 &0.9993 &0.9997 &no \\
	5 &6 &0.9993 &0.9993 &0.9997 &no \\
	5 &7 &0.9994 &0.9994 &1.0000 &no \\
	5 &8 &0.9995 &0.9995 &1.0000 &no \\
	5 &9 &0.9995 &0.9995 &1.0000 &no \\
	5 &10 &0.9995 &0.9995 &1.0000 &no \\
	5 &11 &0.0031 &0.0031 &0.0021 &yes \\
	5 &12 &0.0019 &0.0025 &0.0009 &yes \\
	5 &13 &0.0030 &0.0026 &0.0020 &yes \\
	5 &14 &0.0030 &0.0027 &0.0020 &yes \\
	5 &15 &0.0030 &0.0028 &0.0020 &yes \\
	5 &16 &0.0012 &0.0025 &0.0002 &yes \\
	5 &17 &0.0030 &0.0026 &0.0020 &yes \\
	5 &18 &0.0030 &0.0026 &0.0020 &yes \\
	5 &19 &0.0030 &0.0027 &0.0020 &yes \\
	5 &20 &0.0069 &0.0023 &0.0083 &yes \\
    \bottomrule
  \end{tabular}
\end{table}

For fraggle attack detection, the lack of similarity between legitimate and malicious traffic was more evident than for the evaluation of synflood and port scan detecion. This becaviour can be explained by the number of packets generated through the fraggle attack simulation, that was significative larger than the number of packets generated during the synflood simulation. Considering the three approaches, the largest value for times under attack was 0.0083, while the shortest value for times without attacks was 0.9993. 

Therefore, considering the evaluation for port scan, synflood and fraggle detection, the incremental approach can produce false positive results, while the individual and incremental individualized approaches produce quite similar results, even though the individual approach be more simple and require less memory and processing time.

These results highlight the capabilitiy of change detection based on similarity between legitimate and malicious traffic from DoS or port scan attacks, endorsing the effectiveness and safety for adoption of threshold for attack detection through eigen similarity analysis.

\subsubsection{Port Analysis}
\label{sec:PortAnalysis}

Given $\hat{N}$, which is the set of estimated $n$-th minutes under attack, it is possible to apply cosine similarity analysis to identify variation of the most significant eigenvectors, caused by the insertion of anomalous network traffic by a selected $m$-th port, during a $n$-th minute. Therefore, the incremental individualized and individual approaches of eigen similarity analysis were evaluated, for detection of ports under DoS and port scan attacks, according to results presented in following tables. For this evaluation, the $v$ last most significant eigenvectors without attack was used as reference for similarity analysis against each target port $m$-th.

The Table \ref{tab:tab8} presents the results of the evaluation of eigen similarity analysis for detection of ports under port scan attack, showing only the time frame $q=3$ and minute $n=15$, due to the simulated port scan attack occurred only at this time, although the remain time frame has been completely evaluated and presented high similarity to the reference of traffic without network attack.

\begin{table}[h!]
  \centering
  \footnotesize
  \caption{Eigen Similarity Analysis for Detection of Ports Under Port Scan Attack (q=3 and n=15)}
  \label{tab:tab8}
  \begin{tabular}{ c c c c }
	\toprule
	\multirow{2}{*}{\textbf{Port} $p$}   &\multicolumn{2}{c}{\textbf{Approaches}} &\multirow{2}{*}{\textbf{Attack?}}\\ 
			\hhline{~--~}
			&\textbf{Incremental Individualized} &\textbf{Individual}\\
	\midrule
	80 &0.9999 &0.9999 &no \\
	443 &0.9999 &0.9999 &no \\
	53 &0.9999 &0.9999 &no \\
	21 &0.9999 &0.9997 &yes \\
	22 &0.0298 &0.9997 &yes \\
	23 &0.0298 &0.9997 &yes \\
	25 &0.0298 &0.9997 &yes \\
	110 &0.0298 &0.9997 &yes \\
	143 &0.0298 &0.9997 &yes \\
	161 &0.0298 &0.9997 &yes \\
	69 &0.0298 &0.9997 &yes \\
	123 &0.0298 &0.9997 &yes \\
	445 &0.0298 &0.9997 &yes \\
	600 &0.9999 &0.9999 &no \\
	19 &0.9999 &0.9999 &no \\
	67 &0.9999 &0.9999 &no \\
	68 &0.9999 &0.9999 &no \\
    \bottomrule
  \end{tabular}
\end{table}

The incremental individualized approach presented more sensibility to anomaly detection than the individual approach, the former produced the identification of a low similarity of 0.0298 for almost all ports under attack, unless the port 21, although our simulation has attacked this port. The individual approach was not able to identify low similarity for ports under attack, resunting in values of 0.9997 for ports with anomalous traffic and 0.9999 for ports without network attack.

For the evaluation of the proposed approaches for identification of ports under synflood and fraggle attack, all minutes of each time frame, in which one attack location was estimated, were analyzed. Even though, due to space limitations, only the results of the firt minute where a low similarity was idenfified will be shown such as where $n=11$. Nevertheless, the results obtained for the evaluation of traffic without attack presented high similarity to the reference traffic, with similarities close to 0.9999, and the evaluation of the other minutes under attack presented results quite similar to the resuts shown in the Tables \ref{tab:tab9} and \ref{tab:tab10}.

The Table \ref{tab:tab9} presents the results of the evaluation of eigen similarity analysis for detection of ports under synflood attack, showing only the time frame $q=4$ and minute $n=11$.

\begin{table}[h!]
  \centering
  \footnotesize
  \caption{Eigen Similarity Analysis for Detection of Ports Under Synflood Attack (q=4 and n=11)}
  \label{tab:tab9}
  \begin{tabular}{ c c c c }
	\toprule
	\multirow{2}{*}{\textbf{Port} $p$}   &\multicolumn{2}{c}{\textbf{Approaches}} &\multirow{2}{*}{\textbf{Attack?}}\\ 
			\hhline{~--~}
			&\textbf{Incremental Individualized} &\textbf{Individual}\\
	\midrule
	80 &1.0000 &1.0000 &no \\
	443 &1.0000 &1.0000 &no \\
	53 &1.0000 &1.0000 &no \\
	21 &1.0000 &1.0000 &nos \\
	22 &1.0000 &1.0000 &no \\
	23 &1.0000 &1.0000 &no \\
	25 &1.0000 &1.0000 &no \\
	110 &1.0000 &1.0000 &no \\
	143 &1.0000 &1.0000 &no \\
	161 &1.0000 &1.0000 &no \\
	69 &1.0000 &1.0000 &no \\
	123 &1.0000 &1.0000 &no \\
	445 &1.0000 &1.0000 &no \\
	600 &0.0077 &0.0427 &yes \\
	19 &1.0000 &1.0000 &no \\
	67 &1.0000 &1.0000 &no \\
	68 &1.0000 &1.0000 &no \\
    \bottomrule
  \end{tabular}
\end{table}

According to results presented in Table \ref{tab:tab9}, both approches identifies low similarity for the traffic of port 600, which is the target port of our simulated synflood attack, but the incremental individualized approach identifies the lowest similarity and presents better sensibility to identification of synflood attack through eigen similarity analysis assisted by threshold definition.

The Table \ref{tab:tab10} presents the results of the evaluation of eigen similarity analysis for detection of ports under fraggle attack, showing only the time frame $q=5$ and minute $n=11$.

\begin{table}[h!]
  \centering
  \footnotesize
  \caption{Eigen Similarity Analysis for Detection of Ports Under Fraggle Attack (q=5 and t=11)}
  \label{tab:tab10}
  \begin{tabular}{ c c c c }
	\toprule
	\multirow{2}{*}{\textbf{Port} $p$}   &\multicolumn{2}{c}{\textbf{Approaches}} &\multirow{2}{*}{\textbf{Attack?}}\\ 
			\hhline{~--~}
			&\textbf{Incremental Individualized} &\textbf{Individual}\\
	\midrule
	80 &1.0000 &1.0000 &no \\
	443 &1.0000 &1.0000 &no \\
	53 &1.0000 &1.0000 &no \\
	21 &1.0000 &1.0000 &no \\
	22 &1.0000 &1.0000 &no \\
	23 &1.0000 &1.0000 &no \\
	25 &1.0000 &1.0000 &no \\
	110 &1.0000 &1.0000 &no \\
	143 &1.0000 &1.0000 &no \\
	161 &1.0000 &1.0000 &no \\
	69 &1.0000 &1.0000 &no \\
	123 &1.0000 &1.0000 &no \\
	445 &1.0000 &1.0000 &no \\
	600 &1.0000 &1.0000 &no \\
	19 &0.0031 &0.0004 &yes \\
	67 &1.0000 &1.0000 &no \\
	68 &1.0000 &1.0000 &no \\
    \bottomrule
  \end{tabular}
\end{table}

The results for the avaluation of ports under fraggle attack, shown in Table \ref{tab:tab10}, were similar to the results obtained for synflood analysis, with the identification of low similarity for traffic of the port under attack. Nevertheless, for fraggle analysis, the individual approach identified the lowest similarity, that is 0.0004 while the incremental individualized approach obtained a similarity of 0.0031.

The incremental individualized approach was able to detect low similarity for all evaluated scenarios and types of network attack, while the other approaches presented false positives or low sensibility to eigen similarity analyis for network attack detection. This approach is able to gradually and incrementally adapt to network traffic changing, preserving the sensibility to identify outliers or anomalies by time or network port, and reducing the occurrence of false positives.

According to the shown significant lack of similarity between legitimate and malicious traffic, it is possible to adopt safe thresholds for DoS and port scan detection through eigen similarity analysis.

\section{Conclusion and Future Works}
\label{sec:conclusionandfutureworks}

This paper evaluated the effectiveness of MOS schemes for fraggle attack detection, extending our previous work \cite{tenorio2013greatest} and showing that the analysis of the largest eigenvalues by time frames can be applied to detect the number of port scanning, and DoS attacks, but still requiring more information for detailed attack detection. Therefore, we proposed a novel approach for detailed network attack detection, based on eigen similarity analysis.

The proposed scheme is evaluated and the experimental results show that synflood, fraggle and port scan attacks can be detected accurately and with great detail in an automatic and  blind fashion, applying signal processing concepts for traffic modeling and through approaches based on MOS and eigen similarity analysis. The main contributions of this work were: the extension of an approach based on MOS combined with eigen analysis to blindly detect time frames under network attack; the proposal and evaluation of an eigen similarity based framework to identify details of network attacks, presenting accuracy of timely detection and identification of TCP/UDP ports under attack.

The incremental individualized approach of eigen similarity analysis, is able to detect low similarity for all evaluated scenarios and types of network attack, while the other approaches present false positives or low sensibility to eigen similarity analyis for network attack detection. Therefore, the incremental individualized approach is able to gradually and incrementally adapt to network traffic changing, preserving the sensibility to identify outliers or anomalies by time or network port, and reducing the occurrence of false positives.

According to the significant similarity difference between legitimate and malicious traffic, it is possible to adopt safe thresholds for DoS and port scan detection through eigen similarity analysis.

Future research is directed to the fully automated blind attack detection, extending the evaluation to performance and accuracy analyis of our approach to well-known datasets of network attack detection.

\appendix

\section{Model Order Selection (MOS)}
\label{sec:mos}
The model order selection is a key point in many digital signal processing applications, including radar, sonar, communications, channel modeling, medical imaging, among others. MOS allows analysis of reduced data set, through separating noise components of the main components, for example. Moreover, the model order is crucial for many parameter estimation techniques \cite{da2009comparison}, since the amount of parameters to be estimated depends on the model order.

The model selection procedure chooses the ``best'' model of a finite set of models, according to some criterias \cite{rajan1997model}. Therefore, given some data set, it is chosen a model which was evaluated as the best model to describe the specified data set.

The state of the art regarding estimation techniques of model order based on eigenvalues includes: Akaike's Information Theoretic Criterion - AIC \cite{akaike1974new,wax1985detection}; Minimum Description Length - MDL \cite{barron1998minimum,wax1985detection}; Efficient Detection Criterion - EDC \cite{zhao1986detection}; Stein's Unbiased Risk Estimator - SURE \cite{ulfarsson2008rank}; RADOI \cite{radoi2004new} and Exponential Fitting Test - EFT \cite{grouffaud1996some,quinlan2006model,david2011blind}.

In AIC, MDL and EDC techniques, the information criterion is a function of the geometric mean \emph{g(k)} and the arithmetic mean \emph{a(k)} relating to smaller \emph{k} eigenvalues, where \emph{k} is a candidate value for the model order \emph{d} \cite{da2009comparison}.

Basically, the difference between the AIC, MDL and EDC schemes is the penalty function \emph{p(k, N, α)}, so these techniques can be written in general as \cite{da2009comparison}:

\begin{equation}\label{eq:eq1}
\hat{d} = \argmin\limits_k \hspace{1 mm} J(k), 
\end{equation}

where

\begin{equation}\label{eq:eq2}
J(k) = -N(\alpha - k) \hspace{1 mm} {\rm log} \hspace{1 mm} (g(k)/a(k)) + p(k,N,\alpha),
\end{equation}

where $\hat{d}$ is an estimate \emph{d} of the model order, \emph{N} is the number of samples, \emph{α = M} and means the number of variables of the problem, and 0 ≤ \emph{k} ≤ min[\emph{M}, \emph{N}]. Penalty functions for AIC, MDL and EDC are given by the Table \ref{tab:tab2}.
%% ???

\begin{table}[h!]
  \centering
  \caption{Penalty functions for the schemes AIC, MDL and EDC}
  \label{tab:tab2}
  \begin{tabular}{*2c}
	\toprule
	\textbf{Scheme} &  \textbf{Penalty function} \\
	\textbf{} &  $p(k,N,\alpha)$ \\
	\midrule
    AIC	& $k(2\alpha - k)$ \\
    MDL	& $0.5k(2\alpha - k) \hspace{1 mm} {\rm log} (N)$ \\
    EDC	& $0.5k(2\alpha - k)\sqrt{N\hspace{1 mm}\rm ln(\rm ln N)}$ \\
    \bottomrule
  \end{tabular}
\end{table}

The Exponential Fitting Test (EFT) can effectively be used in cases where the number of samples \emph{N} is small. This technique is based on observations of data contaminated only with white noise, where the profile of eigenvalues can be approximated by an exponential decaying \cite{grouffaud1996some}.

Given $\lambda_i$ be the i-th eigenvalue, the exponential model can be expressed by:
\begin{equation}\label{eq:eq3}
E\{\lambda_i\} = E\{\lambda_1\} \cdot q(\alpha,\beta)^{i-1},
\end{equation}

where $E\{\cdot\} $ is the expectation operator, and it is considered that the eigenvalues are ordered in the that $\lambda_1$ represents the largest eigenvalue. The term \emph{q(α, β)} is defined as:

\begin{equation}\label{eq:eq4}
q(\alpha,\beta) = \exp\left\{-\sqrt{\frac{30}{\alpha^2 + 2} - \sqrt{\frac{900}{(\alpha^2 + 2)^2} - \frac{720\alpha}{\beta(\alpha^4 + \alpha^2 - 2)}}} \right\},
\end{equation}

where $0 < q(\alpha,\beta) < 1$. According to \cite{quinlan2006model}, if $M \leq N$, then $\beta = N$.

%Figure \ref{fig:fig1} shows a typical profile of eigenvalues​​. The last P – 1 eigenvalues are used to estimate the (M - P)-th eigenvalue, denoted by the yellow rectangle. The EFT method considers the discrepancy between the actual value and the estimated value obtained \cite{da2007enhanced}.

%\begin{figure}[h!]
 %    \centering 
     %\includegraphics[height=5cm, width=6cm]{results/figures/fig01.png}
  %   \caption{\csentence{EFT Example.} Example of application of EFT \cite{da2007enhanced}.}
   %  \label{fig:fig1}
%\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Backmatter begins here                   %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{backmatter}

\section*{Competing interests}
  The authors declare that they have no competing interests.

%\section*{Author's contributions}
%    Text for this section \ldots

\section*{Acknowledgements}
The authors thank the Brazilian Ministry of Planning, Budget and Management for the support during the development of this work.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                  The Bibliography                       %%
%%                                                         %%
%%  Bmc_mathpys.bst  will be used to                       %%
%%  create a .BBL file for submission.                     %%
%%  After submission of the .TEX file,                     %%
%%  you will be prompted to submit your .BBL file.         %%
%%                                                         %%
%%                                                         %%
%%  Note that the displayed Bibliography will not          %%
%%  necessarily be rendered by Latex exactly as specified  %%
%%  in the online Instructions for Authors.                %%
%%                                                         %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% if your bibliography is in bibtex format, use those commands:
\bibliographystyle{references} 		% Style BST file
\bibliography{references}	      	% Bibliography file (usually '*.bib' )

% or include bibliography directly:
% \begin{thebibliography}
% \bibitem{b1}
% \end{thebibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Figures                       %%
%%                               %%
%% NB: this is for captions and  %%
%% Titles. All graphics must be  %%
%% submitted separately and NOT  %%
%% included in the Tex document  %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%
%% Do not use \listoffigures as most will included as separate files

%\section*{Figures}
%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig01.png}
%     \caption{\csentence{EFT Example.} Example of application of EFT \cite{da2007enhanced}.}
%     \label{fig:fig1}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig02.png}
%     \caption{\csentence{Traffic Matrix.} Obtaining the traffic matrix $\boldsymbol{X}^{(q)}$.}
%     \label{fig:fig2}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig03.png}
%     \caption{\csentence{Legitimate Traffic.} The legitimate traffic.}
%     \label{fig:fig3}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig04.png}
%     \caption{\csentence{Noise Traffic.} The noise traffic.}
%     \label{fig:fig4}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig05.png}
%     \caption{\csentence{Synflood Traffic.} The traffic characterized by synflood.}
%     \label{fig:fig5}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig06.png}
%     \caption{\csentence{Fraggle Traffic.} The traffic characterized by fraggle.}
%     \label{fig:fig6}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig07.png}
%     \caption{\csentence{Port scan Traffic.} The traffic characterized by port scan.}
%     \label{fig:fig7}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig08.png}
%     \caption{\csentence{GETV.} Proposed GETV attack detection approach.}
%     \label{fig:fig8}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig09.png}
%     \caption{\csentence{Scenario.} Analyzed Scenario.}
%     \label{fig:fig9}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig10.png}
%     \caption{\csentence{Synflood Eigenvalues.} Eigenvalues of the covariance matrix (synflood).}
%     \label{fig:fig10}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig11.png}
%     \caption{\csentence{Fraggle Eigenvalues.} Eigenvalues of the covariance matrix (fraggle).}
%     \label{fig:fig11}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig12.png}
%     \caption{\csentence{Port scan Eigenvalues.} Eigenvalues of the covariance matrix (port scan).}
%     \label{fig:fig12}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig13.png}
%     \caption{\csentence{Synflood Components.} The two first principal components (synflood).}
%     \label{fig:fig13}
%\end{figure}

%\begin{figure}[h!]
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig14.png}
%     \caption{\csentence{Fraggle Components.} The two first principal components (fraggle).}
%     \label{fig:fig14}
%\end{figure}

%\begin{figure}[h!]	
%     \centering 
%     %\includegraphics[height=10cm, width=10cm]{figures/fig15.png}
%     \caption{\csentence{Port scan Components.} The two first principal components (port scan).}
%     \label{fig:fig15}
%\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Tables                        %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Use of \listoftables is discouraged.
%%
%\section*{Tables}
%\begin{table}[h!]
%  \centering
%  \footnotesize
%  \caption{Comparison between malicious traffic detection schemes of related works and of this paper}
%  \label{tab:tab1}
%  \begin{tabular}{ c c c c c c }
%	\toprule
%	\multirow{2}{*}{\textbf{Related Works}} &\multicolumn{5}{c }{\textbf{Techniques}}\\ 
%		&\textbf{Data Mining}	 &\textbf{Regular analysis of files}	 &\textbf{PCA}	 &\textbf{MOS}	 &\textbf{GETV}\\
%	\midrule
%	(He et al, 2008)		&x	&-	&-	&-	&- \\
%	(Raynal et al, 2004) 	&-	&x	&-	&-	&- \\
%	(Almotairi et al, 2009)	&-	&-	&x	&-	&- \\
%	(da Costa et al, 2012) 	&-	&-	&x	&x	&- \\
%	(Proposed) 				& -	& -	&x	&x	&x \\
%   \bottomrule
%  \end{tabular}
%\end{table}
%\begin{table}[h!]
%  \centering
%  \caption{Penalty functions for the schemes AIC, MDL and EDC}
%  \label{tab:tab2}
%  \begin{tabular}{*2c}
%	\toprule
%	\textbf{Scheme} &  \textbf{Penalty function} \\
%	\textbf{} &  $p(k,N,\alpha)$ \\
%	\midrule
%    AIC	& $k(2\alpha - k)$ \\
%    MDL	& $0.5k(2\alpha - k) \hspace{1 mm} log(N)$ \\
%    EDC	& $0.5k(2\alpha - k)\sqrt{N\hspace{1 mm}ln(lnN)}$ \\
%    \bottomrule
%  \end{tabular}
%\end{table}
%\begin{table}[h!]
%  \centering
%  \footnotesize
%  \caption{Greatest Eigenvalue related to attacks detection}
%  \label{tab:tab3}
%  \begin{tabular}{ c c c c c }
%	\toprule
%	\multirow{3}{*}{\textbf{Time Period} $q$} &\multicolumn{4}{c }{\textbf{Vectors GETV}}\\ 
%			\hhline{~----}
%		&\textbf{Detection of}	 &\textbf{Detection of}	 &\textbf{Detection of}	 &\textbf{Detection of}\\
%		&\textbf{\emph{synflood/fraggle}}	 &\textbf{\emph{synflood}}	 &\textbf{\emph{fraggle}}	 &\textbf{\emph{port scan}}\\
%	\midrule
%	1 &1887545 &1887545 &1887545 &2,0734 \\
%	2 &2341327 &2341327 &2341327 &2,1451 \\
%	3 &3213867 &3213867 &3213867 &10,0718 \\
%	4 &133238294 &133238294 &731229 &2,1620 \\
%	5 &92384021611 &6367983 &92384021611 &2,4253 \\
%	6 &708335 &708335 &708335 &1,7948 \\
%    \bottomrule
%  \end{tabular}
%\end{table}
%\begin{table}[h!]
%  \centering
%  \footnotesize
%  \caption{MOS schemes applied to the GETV}
%  \label{tab:tab4}
%  \begin{tabular}{ c c c c c c c c }
%	\toprule
%	\multirow{2}{*}{\textbf{Type of analysis} $q$} &\multicolumn{6}{c}{\textbf{MOS schemes (estimated model order $\hat{d}$)}} %&{\textbf{Real value (d)}}\\ 
%			\hhline{~------~}
%		&\textbf{AIC} &\textbf{MDL} &\textbf{EDC} &\textbf{RADOI} &\textbf{EFT} &\textbf{SURE}\\
%	\midrule
%	Detection of synflood \\(presence of attack) &2 &1 &\textbf{1} &5 &\textbf{1} &4 &\textbf{1} \\
%	Detection of synflood \\(absence of attack) &1 &1 &\textbf{0} &1 &\textbf{0} &3 &\textbf{0} \\
%	\midrule
%	Detection of fraggle \\(presence of attack) &1 &1 &\textbf{1} &5 &\textbf{1} &4 &\textbf{1} \\
%	Detection of fraggle \\(absence of attack) &1 &1 &\textbf{0} &1 &\textbf{0} &3 &\textbf{0} \\
%	\midrule
%	Detection of port scan \\(presence of attack) &1 &1 &\textbf{1} &1 &\textbf{1} &9 &\textbf{1} \\
%	Detection of port scan \\(absence of attack) &0 &0 &\textbf{0} &1 &\textbf{0} &1 &\textbf{0} \\
%	\midrule
%	Detection of synflood/fraggle \\(presence of attack) &2 &2 &\textbf{2} &5 &\textbf{2} &5 &\textbf{2} \\
%	Detection of synflood/fraggle \\(absence of attack) &1 &1 &\textbf{0} &1 &\textbf{0} &3 &\textbf{0} \\
%    \bottomrule
%  \end{tabular}
%\end{table}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Additional Files              %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\section*{Additional Files}
%  \subsection*{Additional file 1 --- Sample additional file title}
%    Additional file descriptions text (including details of how to view the file, if it is in a non-standard format or the file extension). This might refer to a multi-page table or a figure.

%  \subsection*{Additional file 2 --- Sample additional file title}
%    Additional file descriptions text.

\end{backmatter}
\end{document}