
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>eigensimilarity</title><meta name="generator" content="MATLAB 8.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-10-11"><meta name="DC.source" content="eigensimilarity.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput">clc;
clear <span class="string">all</span>;
close <span class="string">all</span>;

addpath(<span class="string">'eigendecomposition/'</span>);
addpath(<span class="string">'/home/thiago/dev/matlab/mos/'</span>);

matrices = {<span class="string">'all'</span>;<span class="string">'signal'</span>;<span class="string">'noise'</span>;<span class="string">'portscan'</span>;<span class="string">'synflood'</span>;<span class="string">'fraggle'</span>};
numberOfMatrices = size(matrices,1); <span class="comment">%6 matrices</span>
ports = [80,443,53,21,22,23,25,110,143,161,69,123,445,600,19,67,68];
numberOfPorts = size(ports,2); <span class="comment">%17 ports</span>
numPeriods = 6;
periodsSize = 20;
numMinutes = 120;
threshold = 0.4;

<span class="comment">% incremental individualized</span>
<span class="keyword">for</span> matrix = 4:numberOfMatrices
    <span class="keyword">switch</span> matrix
        <span class="keyword">case</span> 1 <span class="comment">%all</span>
            q = 4;
        <span class="keyword">case</span> 2 <span class="comment">%signal</span>
            q = 4;
		<span class="keyword">case</span> 3 <span class="comment">%noise</span>
			q = 4;
		<span class="keyword">case</span> 4 <span class="comment">%portscan</span>
            q = 3;
		<span class="keyword">case</span> 5 <span class="comment">%synflood</span>
            q = 4;
   		<span class="keyword">case</span> 6 <span class="comment">%fraggle</span>
			q = 5;
    <span class="keyword">end</span>
    X0 = dlmread([<span class="string">'../data/all/traffic/'</span> num2str(2) <span class="string">'.txt'</span>], <span class="string">'\t'</span>);
    <span class="keyword">if</span> (q == 3)
        [S0,E0,Vr0,Mr0] = eigencorrelation(X0);
    <span class="keyword">else</span>
        [S0,E0,Vr0,Mr0] = eigencovariance(X0);
    <span class="keyword">end</span>
    X = dlmread([<span class="string">'../data/all/traffic/'</span> num2str(q) <span class="string">'.txt'</span>], <span class="string">'\t'</span>);
    t_attacks = {};
    <span class="keyword">for</span> t = 1:periodsSize
        Xc = cat(2,X0,X(:,1:t));
        <span class="keyword">if</span> (q == 3)
            [Sc,Ec,Vrc,Mrc] = eigencorrelation(Xc);
        <span class="keyword">else</span>
            [Sc,Ec,Vrc,Mrc] = eigencovariance(Xc);
        <span class="keyword">end</span>
        cosTheta(t) = dot(Vr0(:,Mr0(2)),Vrc(:,Mrc(2)))/(norm(Vr0(:,Mr0(2)))*norm(Vrc(:,Mrc(2))));
        cosTheta(t)  = abs(cosTheta(t));
        warning(<span class="string">'Matrix = %s, Period(q) = %s, Time(t) = %s, cosTheta= %s'</span>,matrices{matrix},num2str(q),num2str(t),cosTheta(t));
        <span class="keyword">if</span>(cosTheta(t) &lt; threshold)
            X0 = cat(2,X0,X(:,1:t-1));
            ports = findport(X0,X(:,t),q == 3,threshold);
            <span class="comment">%warning('Matrix = %s, Period(q) = %s, Time(t) = %s, Ports= %s',matrices{matrix},num2str(q),num2str(t),mat2str(ports));</span>
            t = t + 1;
            <span class="keyword">for</span> a = t:periodsSize
                <span class="keyword">if</span> (q == 3)
                    [S,E,Vrc,Mrc] = eigencorrelation(cat(2,X0,X(:,a)));
                <span class="keyword">else</span>
                    [S,E,Vrc,Mrc] = eigencovariance(cat(2,X0,X(:,a)));
                <span class="keyword">end</span>
                cosTheta(a) = dot(Vr0(:,Mr0(2)),Vrc(:,Mrc(2)))/(norm(Vr0(:,Mr0(2)))*norm(Vrc(:,Mrc(2))));
                cosTheta(a)  = abs(cosTheta(a));
                warning(<span class="string">'Matrix = %s, Period(q) = %s, Time(t) = %s, cosTheta= %s'</span>,matrices{matrix},num2str(q),num2str(a),cosTheta(t));
                <span class="keyword">if</span>(cosTheta(a) &lt; threshold)
                    ports = findport(X0,X(:,a),q == 3,threshold);
                    <span class="comment">%warning('Matrix = %s, Period(q) = %s, Time(t) = %s, Ports= %s',matrices{matrix},num2str(q),num2str(a),mat2str(ports));</span>
                <span class="keyword">end</span>
            <span class="keyword">end</span>
            <span class="keyword">break</span>;
        <span class="keyword">end</span>
    <span class="keyword">end</span>
    similarity{matrix} = cosTheta;
<span class="keyword">end</span>

<span class="comment">% incremental individualized</span>
<span class="comment">% for matrix = 4:numberOfMatrices</span>
<span class="comment">%     switch matrix</span>
<span class="comment">%         case 1 %all</span>
<span class="comment">%             q = 4;</span>
<span class="comment">%         case 2 %signal</span>
<span class="comment">%             q = 4;</span>
<span class="comment">% 		case 3 %noise</span>
<span class="comment">% 			q = 4;</span>
<span class="comment">% 		case 4 %portscan</span>
<span class="comment">%             q = 3;</span>
<span class="comment">% 		case 5 %synflood</span>
<span class="comment">%             q = 4;</span>
<span class="comment">%    		case 6 %fraggle</span>
<span class="comment">% 			q = 5;</span>
<span class="comment">%     end</span>
<span class="comment">%     X0 = dlmread(['../data/all/traffic/' num2str(2) '.txt'], '\t');</span>
<span class="comment">%     if (q == 3)</span>
<span class="comment">%         [S0,E0,Vr0,Mr0] = eigencorrelation(X0);</span>
<span class="comment">%     else</span>
<span class="comment">%         [S0,E0,Vr0,Mr0] = eigencovariance(X0);</span>
<span class="comment">%     end</span>
<span class="comment">%     X = dlmread(['../data/all/traffic/' num2str(q) '.txt'], '\t');</span>
<span class="comment">%     t_attacks = {};</span>
<span class="comment">%     for t = 1:periodsSize</span>
<span class="comment">%         Xc = cat(2,X0,X(:,1:t));</span>
<span class="comment">%         if (q == 3)</span>
<span class="comment">%             [Sc,Ec,Vrc,Mrc] = eigencorrelation(Xc);</span>
<span class="comment">%         else</span>
<span class="comment">%             [Sc,Ec,Vrc,Mrc] = eigencovariance(Xc);</span>
<span class="comment">%         end</span>
<span class="comment">%         cosTheta(t) = dot(Vr0(:,Mr0(2)),Vrc(:,Mrc(2)))/(norm(Vr0(:,Mr0(2)))*norm(Vrc(:,Mrc(2))));</span>
<span class="comment">%         cosTheta(t)  = abs(cosTheta(t));</span>
<span class="comment">%         warning('Matrix = %s, Period(q) = %s, Time(t) = %s, cosTheta= %s',matrices{matrix},num2str(q),num2str(t),cosTheta(t));</span>
<span class="comment">%     end</span>
<span class="comment">%     similarity{matrix} = cosTheta;</span>
<span class="comment">% end</span>

<span class="comment">% individual</span>
<span class="comment">% for matrix = 4:numberOfMatrices</span>
<span class="comment">%     switch matrix</span>
<span class="comment">%         case 1 %all</span>
<span class="comment">%             q = 4;</span>
<span class="comment">%         case 2 %signal</span>
<span class="comment">%             q = 4;</span>
<span class="comment">% 		case 3 %noise</span>
<span class="comment">% 			q = 4;</span>
<span class="comment">% 		case 4 %portscan</span>
<span class="comment">%             q = 3;</span>
<span class="comment">% 		case 5 %synflood</span>
<span class="comment">%             q = 4;</span>
<span class="comment">%    		case 6 %fraggle</span>
<span class="comment">% 			q = 5;</span>
<span class="comment">%     end</span>
<span class="comment">%     X0 = dlmread(['../data/all/traffic/' num2str(2) '.txt'], '\t');</span>
<span class="comment">%     if (q == 3)</span>
<span class="comment">%         [S0,E0,Vr0,Mr0] = eigencorrelation(X0);</span>
<span class="comment">%     else</span>
<span class="comment">%         [S0,E0,Vr0,Mr0] = eigencovariance(X0);</span>
<span class="comment">%     end</span>
<span class="comment">%     X = dlmread(['../data/all/traffic/' num2str(q) '.txt'], '\t');</span>
<span class="comment">%     t_attacks = {};</span>
<span class="comment">%     for t = 1:periodsSize</span>
<span class="comment">%         Xc = cat(2,X0,X(:,t));  % only the target column</span>
<span class="comment">%         if (q == 3)</span>
<span class="comment">%             [Sc,Ec,Vrc,Mrc] = eigencorrelation(Xc);</span>
<span class="comment">%         else</span>
<span class="comment">%             [Sc,Ec,Vrc,Mrc] = eigencovariance(Xc);</span>
<span class="comment">%         end</span>
<span class="comment">%         cosTheta(t) = dot(Vr0(:,Mr0(2)),Vrc(:,Mrc(2)))/(norm(Vr0(:,Mr0(2)))*norm(Vrc(:,Mrc(2))));</span>
<span class="comment">%         cosTheta(t)  = abs(cosTheta(t));</span>
<span class="comment">%         warning('Matrix = %s, Period(q) = %s, Time(t) = %s, cosTheta= %s',matrices{matrix},num2str(q),num2str(t),cosTheta(t));</span>
<span class="comment">%     end</span>
<span class="comment">%     similarity{matrix} = cosTheta;</span>
<span class="comment">% end</span>
</pre><pre class="codeoutput">Warning: Matrix = portscan, Period(q) = 3, Time(t) = 1, cosTheta= 9.946004e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 2, cosTheta= 9.934438e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 3, cosTheta= 9.912079e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 4, cosTheta= 9.887671e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 5, cosTheta= 9.856343e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 6, cosTheta= 9.840420e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 7, cosTheta= 9.824148e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 8, cosTheta= 9.793990e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 9, cosTheta= 9.672916e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 10, cosTheta= 9.673561e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 11, cosTheta= 9.733130e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 12, cosTheta= 9.701868e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 13, cosTheta= 9.676600e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 14, cosTheta= 9.646321e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 15, cosTheta= 2.234010e-02 

cosTheta =

    0.9999


cosTheta =

    0.9999


cosTheta =

    0.9999


cosTheta =

    0.9999


cosTheta =

    0.0298


cosTheta =

    0.0298


cosTheta =

    0.0298


cosTheta =

    0.0298


cosTheta =

    0.0298


cosTheta =

    0.0298


cosTheta =

    0.0298


cosTheta =

    0.0298


cosTheta =

    0.0298


cosTheta =

    0.9999


cosTheta =

    0.9999


cosTheta =

    0.9999


cosTheta =

    0.9999

Warning: Matrix = portscan, Period(q) = 3, Time(t) = 16, cosTheta= 9.621313e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 17, cosTheta= 9.621313e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 18, cosTheta= 9.621313e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 19, cosTheta= 9.621313e-01 
Warning: Matrix = portscan, Period(q) = 3, Time(t) = 20, cosTheta= 9.621313e-01 
Warning: Matrix = synflood, Period(q) = 4, Time(t) = 1, cosTheta= 9.999731e-01 
Warning: Matrix = synflood, Period(q) = 4, Time(t) = 2, cosTheta= 9.998682e-01 
Warning: Matrix = synflood, Period(q) = 4, Time(t) = 3, cosTheta= 9.996975e-01 
Warning: Matrix = synflood, Period(q) = 4, Time(t) = 4, cosTheta= 9.997781e-01 
Warning: Matrix = synflood, Period(q) = 4, Time(t) = 5, cosTheta= 9.964672e-01 
Warning: Matrix = synflood, Period(q) = 4, Time(t) = 6, cosTheta= 9.974797e-01 
Warning: Matrix = synflood, Period(q) = 4, Time(t) = 7, cosTheta= 9.976724e-01 
Warning: Matrix = synflood, Period(q) = 4, Time(t) = 8, cosTheta= 9.980047e-01 
Warning: Matrix = synflood, Period(q) = 4, Time(t) = 9, cosTheta= 9.986744e-01 
Warning: Matrix = synflood, Period(q) = 4, Time(t) = 10, cosTheta= 9.990843e-01 
Warning: Matrix = synflood, Period(q) = 4, Time(t) = 11, cosTheta= 8.476012e-03 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0077


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = synflood, Period(q) = 4, Time(t) = 12, cosTheta= 1.629007e-02 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0155


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = synflood, Period(q) = 4, Time(t) = 13, cosTheta= 1.629007e-02 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0243


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = synflood, Period(q) = 4, Time(t) = 14, cosTheta= 1.629007e-02 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.1245


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = synflood, Period(q) = 4, Time(t) = 15, cosTheta= 1.629007e-02 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0088


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = synflood, Period(q) = 4, Time(t) = 16, cosTheta= 1.629007e-02 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0396


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = synflood, Period(q) = 4, Time(t) = 17, cosTheta= 1.629007e-02 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0390


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = synflood, Period(q) = 4, Time(t) = 18, cosTheta= 1.629007e-02 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0399


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = synflood, Period(q) = 4, Time(t) = 19, cosTheta= 1.629007e-02 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0399


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = synflood, Period(q) = 4, Time(t) = 20, cosTheta= 1.629007e-02 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0465


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 1, cosTheta= 9.999595e-01 
Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 2, cosTheta= 9.998770e-01 
Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 3, cosTheta= 9.999623e-01 
Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 4, cosTheta= 9.998557e-01 
Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 5, cosTheta= 9.993143e-01 
Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 6, cosTheta= 9.993334e-01 
Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 7, cosTheta= 9.994413e-01 
Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 8, cosTheta= 9.994978e-01 
Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 9, cosTheta= 9.994805e-01 
Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 10, cosTheta= 9.994882e-01 
Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 11, cosTheta= 3.128498e-03 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0031


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 12, cosTheta= 1.882180e-03 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0019


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 13, cosTheta= 1.882180e-03 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0030


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 14, cosTheta= 1.882180e-03 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0030


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 15, cosTheta= 1.882180e-03 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0030


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 16, cosTheta= 1.882180e-03 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0012


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 17, cosTheta= 1.882180e-03 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0030


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 18, cosTheta= 1.882180e-03 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0030


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 19, cosTheta= 1.882180e-03 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0030


cosTheta =

    1.0000


cosTheta =

    1.0000

Warning: Matrix = fraggle, Period(q) = 5, Time(t) = 20, cosTheta= 1.882180e-03 

cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    1.0000


cosTheta =

    0.0069


cosTheta =

    1.0000


cosTheta =

    1.0000

</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014b</a><br></p></div><!--
##### SOURCE BEGIN #####
clc;
clear all;
close all;

addpath('eigendecomposition/');
addpath('/home/thiago/dev/matlab/mos/');

matrices = {'all';'signal';'noise';'portscan';'synflood';'fraggle'};
numberOfMatrices = size(matrices,1); %6 matrices
ports = [80,443,53,21,22,23,25,110,143,161,69,123,445,600,19,67,68];
numberOfPorts = size(ports,2); %17 ports
numPeriods = 6;
periodsSize = 20;
numMinutes = 120;
threshold = 0.4;

% incremental individualized
for matrix = 4:numberOfMatrices    
    switch matrix		
        case 1 %all
            q = 4;
        case 2 %signal			
            q = 4;
		case 3 %noise            
			q = 4;
		case 4 %portscan
            q = 3;
		case 5 %synflood 
            q = 4;
   		case 6 %fraggle 
			q = 5;
    end    
    X0 = dlmread(['../data/all/traffic/' num2str(2) '.txt'], '\t');
    if (q == 3)
        [S0,E0,Vr0,Mr0] = eigencorrelation(X0);
    else
        [S0,E0,Vr0,Mr0] = eigencovariance(X0);
    end
    X = dlmread(['../data/all/traffic/' num2str(q) '.txt'], '\t');
    t_attacks = {};
    for t = 1:periodsSize
        Xc = cat(2,X0,X(:,1:t));
        if (q == 3)
            [Sc,Ec,Vrc,Mrc] = eigencorrelation(Xc);
        else
            [Sc,Ec,Vrc,Mrc] = eigencovariance(Xc);
        end
        cosTheta(t) = dot(Vr0(:,Mr0(2)),Vrc(:,Mrc(2)))/(norm(Vr0(:,Mr0(2)))*norm(Vrc(:,Mrc(2))));
        cosTheta(t)  = abs(cosTheta(t));
        warning('Matrix = %s, Period(q) = %s, Time(t) = %s, cosTheta= %s',matrices{matrix},num2str(q),num2str(t),cosTheta(t));
        if(cosTheta(t) < threshold)
            X0 = cat(2,X0,X(:,1:t-1));
            ports = findport(X0,X(:,t),q == 3,threshold);
            %warning('Matrix = %s, Period(q) = %s, Time(t) = %s, Ports= %s',matrices{matrix},num2str(q),num2str(t),mat2str(ports));
            t = t + 1;                
            for a = t:periodsSize
                if (q == 3)
                    [S,E,Vrc,Mrc] = eigencorrelation(cat(2,X0,X(:,a)));
                else
                    [S,E,Vrc,Mrc] = eigencovariance(cat(2,X0,X(:,a)));
                end
                cosTheta(a) = dot(Vr0(:,Mr0(2)),Vrc(:,Mrc(2)))/(norm(Vr0(:,Mr0(2)))*norm(Vrc(:,Mrc(2))));                
                cosTheta(a)  = abs(cosTheta(a));
                warning('Matrix = %s, Period(q) = %s, Time(t) = %s, cosTheta= %s',matrices{matrix},num2str(q),num2str(a),cosTheta(t));
                if(cosTheta(a) < threshold)
                    ports = findport(X0,X(:,a),q == 3,threshold);
                    %warning('Matrix = %s, Period(q) = %s, Time(t) = %s, Ports= %s',matrices{matrix},num2str(q),num2str(a),mat2str(ports));
                end
            end
            break;
        end
    end        
    similarity{matrix} = cosTheta;
end

% incremental individualized
% for matrix = 4:numberOfMatrices    
%     switch matrix		
%         case 1 %all
%             q = 4;
%         case 2 %signal			
%             q = 4;
% 		case 3 %noise            
% 			q = 4;
% 		case 4 %portscan
%             q = 3;
% 		case 5 %synflood 
%             q = 4;
%    		case 6 %fraggle 
% 			q = 5;
%     end    
%     X0 = dlmread(['../data/all/traffic/' num2str(2) '.txt'], '\t');
%     if (q == 3)
%         [S0,E0,Vr0,Mr0] = eigencorrelation(X0);
%     else
%         [S0,E0,Vr0,Mr0] = eigencovariance(X0);
%     end
%     X = dlmread(['../data/all/traffic/' num2str(q) '.txt'], '\t');
%     t_attacks = {};
%     for t = 1:periodsSize
%         Xc = cat(2,X0,X(:,1:t));
%         if (q == 3)
%             [Sc,Ec,Vrc,Mrc] = eigencorrelation(Xc);
%         else
%             [Sc,Ec,Vrc,Mrc] = eigencovariance(Xc);
%         end
%         cosTheta(t) = dot(Vr0(:,Mr0(2)),Vrc(:,Mrc(2)))/(norm(Vr0(:,Mr0(2)))*norm(Vrc(:,Mrc(2))));
%         cosTheta(t)  = abs(cosTheta(t));
%         warning('Matrix = %s, Period(q) = %s, Time(t) = %s, cosTheta= %s',matrices{matrix},num2str(q),num2str(t),cosTheta(t));        
%     end        
%     similarity{matrix} = cosTheta;
% end

% individual
% for matrix = 4:numberOfMatrices    
%     switch matrix		
%         case 1 %all
%             q = 4;
%         case 2 %signal			
%             q = 4;
% 		case 3 %noise            
% 			q = 4;
% 		case 4 %portscan
%             q = 3;
% 		case 5 %synflood 
%             q = 4;
%    		case 6 %fraggle 
% 			q = 5;
%     end    
%     X0 = dlmread(['../data/all/traffic/' num2str(2) '.txt'], '\t');
%     if (q == 3)
%         [S0,E0,Vr0,Mr0] = eigencorrelation(X0);
%     else
%         [S0,E0,Vr0,Mr0] = eigencovariance(X0);
%     end
%     X = dlmread(['../data/all/traffic/' num2str(q) '.txt'], '\t');
%     t_attacks = {};
%     for t = 1:periodsSize
%         Xc = cat(2,X0,X(:,t));  % only the target column
%         if (q == 3)
%             [Sc,Ec,Vrc,Mrc] = eigencorrelation(Xc);
%         else
%             [Sc,Ec,Vrc,Mrc] = eigencovariance(Xc);
%         end
%         cosTheta(t) = dot(Vr0(:,Mr0(2)),Vrc(:,Mrc(2)))/(norm(Vr0(:,Mr0(2)))*norm(Vrc(:,Mrc(2))));
%         cosTheta(t)  = abs(cosTheta(t));
%         warning('Matrix = %s, Period(q) = %s, Time(t) = %s, cosTheta= %s',matrices{matrix},num2str(q),num2str(t),cosTheta(t));        
%     end        
%     similarity{matrix} = cosTheta;
% end
##### SOURCE END #####
--></body></html>